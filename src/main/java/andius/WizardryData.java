package andius;

import andius.dialogs.BathInPoolDialog;
import andius.dialogs.BuyStTreborsRumpDialog;
import andius.dialogs.DukesDialog;
import andius.dialogs.WitchInMazeDialog;
import andius.dialogs.GatesOfHellDialog;
import andius.dialogs.VanishingCreamDialog;
import andius.dialogs.ZigguratAltarDialog;
import andius.objects.Dice;
import andius.objects.DoGooder;
import andius.objects.Function;
import andius.objects.Item;
import andius.objects.Monster;
import andius.objects.Reward;
import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import com.google.gson.reflect.TypeToken;
import jakarta.xml.bind.DatatypeConverter;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Objects;
import java.util.Random;
import org.apache.commons.io.EndianUtils;
import org.apache.commons.io.IOUtils;
import utils.Utils;
import static utils.Utils.intValue;

public class WizardryData {

    public static final int DUNGEON_DIM = 20;
    private static final Random RANDOM = new Random();

    public enum CellType {
        NORMAL, STAIRS, PIT, CHUTE, SPINNER, DARK, TELEPORT, DAMAGE, ELEVATOR, ROCK, NOSPELL, MESSAGE, ENCOUNTER
    }

    public enum SummoningCircle {
        CIRCLE1(0, 11, "First"),
        CIRCLE2(12, 23, "Second"),
        CIRCLE3(24, 35, "Third"),
        CIRCLE4(36, 47, "Fourth"),
        CIRCLE5(48, 59, "Fifth"),
        CIRCLE6(60, 71, "Sixth"),
        CIRCLE7(72, 83, "Seventh"),
        CIRCLE8(84, 95, "Eighth"),
        CIRCLE9(96, 107, "Ninth"),
        CIRCLE10(108, 119, "Tenth");

        private final int rangeLow;
        private final int rangeHigh;
        private final String display;

        private SummoningCircle(int rangeLow, int rangeHigh, String display) {
            this.rangeLow = rangeLow;
            this.rangeHigh = rangeHigh;
            this.display = display;
        }

        public int low() {
            return rangeLow;
        }

        public int high() {
            return rangeHigh;
        }

        public String display() {
            return display;
        }

    }

    //wizardry 1 proving grounds
    private static final String L1 = "555555555500545500040800500000007400005540914500005500944D00501440064000144040066400004000500300001440550100555546555500000001008100545551555500505550559900705550551500B09A50559A00301050550000605750B5990040555001000050155099590054154010400001005414640005005518540015015514A400150254804200150155149400094495105400458454140400494455040400450055020C0001000100410000000404000005002400000055551500D00055D52500D000956015005400952025007500550054581500150025581600054055D3C400010055D3C4005455000C040050000000740000554091450000550094C50050144006400014404006E40000400050010000144055010055554655550000000100810055555155550050555055950050D550551500907A5055990010105055000060555095990040557001000050155099590054154010400055555D555500000015055900014015069500454015056900850015A050004540150D6500015125045500112115054100125115014100114095004200004000405000000001010000010009004000F57F05007400555509007400155805005500254809405D001500155645000540099645000150D53471000140E534710000D8030000D801000CD809000C0000000CC089A860C021B266D81FB166180E0006003E9200000000000050000000000000000C0000000C0000000A0000000A0000B80F0000A00F0000F80F0000F80F00010000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000AAAAAAAA0000A3AAAA4AAAAAAAAA0900A0AAAAAA0A0000000000000000000A0000000000000000000A7065000000000000080A0000000000000000000A0000000000000000000A0000000000000000000A0000000000000000000A0000000000000000000A00000000000000000010B16BBB8B050000000000000200FFFFFFFF01004D00B7FBB6FB00000000000000000000000000000000000007000000030004000B00120018000400000000000000000000000000000000000C00010008000F000400040004000100000000000000000000000000000000000000040000000100000000000500000003000000000003000000";
    private static final String L2 = "0555455555000055010000005555065405007401005001004049454101000054454101004001005001005405005405001041650105001405140010000010295414000050155514001405541510001041011055005605006515000000005405005555155001005756164001000000005005009D95155415001101500000001102540000000110510410000554521410004508801A1600450450141000050090041000051050000000455102061900455055056500858049096A00455000026500455144411900051040510000410040014000410040055000020000155500111151155000111151054000010040010000005D010000005555065805005401005001004049454101000054454101004001005001005405005405001041650105001405140010000010295414000050155514001405541510001041011055005605006715000000005405005555255001005756164003000000005005009D95155415000555455555004C00140040008400150040000044140144000195140544001102A0864500110114054400010018014400010414004000519480414600115455415900216052825A0011248040590051145150460001045014400010005000500010005001540000004045550044445405540044446401500000005000400000000000000000000003000000030000180081A8180020B2000010B13E0000003E0032923E0606007E0656003E0006003E0002003E400000070000000700000000000000FF030000FF030000000000000000000000000000000000000000000000000000000000000000A0AAAA00000000000000A0AAAA000000000000E0AFAAAB00000000000000A0AAAA00000000000000A0AAAA0000000000000000000000000000200000030000000000000000000000000C000000009000000000000000000000000000000000000D100080000000000000000000700000000000000000006000000000000000000050000000000000000000000040000000000000000000000000000000000000000000000000000000000000000010BBB1BB82B5BBBB00000100610062000300FFFFFFFFFFFF000000000000B5FBB9FBB8FB5F00600000000A00200024000B0029002B002D0008000400000012002F0032008A008A0000000000050005000F000100010001000200010000000400040004000500050007000000000005000000080000000000050000000A000000000005000000";
    private static final String L3 = "15151515150015151515150000001900000019191919190000000000000015151515150015155515150000005001000019199403190000008004000015154109150015159515150000000000000019191919190000000000000015151515150015151515150000000000000019191919190000000000000000000000000043435743430041416A414100414141414100C1C1C1C1C100000000000000434305504300414105554100414145694100C1C15551C100000091500000434341434300414141414100414141414100C1C1C1C1C100000000000000434343434300414141414100414141414100C1C1C1C1C100151515151500000025000000191919191900000000000000151515151500151555151500000050010000191994031900000080040000151542091500151555151500000000000000191919191900000000000000151515151500151515151500000000000000191919191900000000000000151515151500000000000000D0D0D9D0D000505056505000505050505000707070707000000000000000D05001D4D000505041555000505051565000707065547000004014140000D050D0D0D000505050505000505050505000707070707000000000000000D0D0D0D0D00050505050500050505050500070707070700000000000777707007777070077770700777787A8000020B2770017B177100700770837927708070000005000777707007777070077770700777707000000000077770700777707007777070077770700003000400040008000300000000002000000000000000000000000000000000000000000000000000000000000000000000000A000900040009000400000000000000000000000000000000000000000000000000000000000000000000000000000000000900080070000A000300000000000000000000000000000000000000000000000000000000050000000000000000000000000300080001000A00040000000000000000000000000000000000000000000000000000000000000000000000000000000001041C286BB0B000000000200040000000000050003000000FFFFFFFFFFFF0000000000000000000000000F0012000000080004000100040039003B003D0000000000000000000000000010000A000000030028000D000100010001000100000000000000000000000F00000000000A0000000E00000000000A0000001400000000000A000A00";
    private static final String L4 = "505501000000501500000000602500000000206055551500206055510500602500500900501500000800000000500900000000540500000000000100555555150100555565150100605D52000000200002590000200002040000200002000000200002000000205056550500205056551500605D02000000000000000000906A00000000505000000000905080004000505000A45A00906A00145400000000145400000000A45A0000000040560000000040530029002880560090AA9642510050140581510050140514500050140500500050140500500090140500500050F40108400050140500000090AA06000000501500000000602500000000206055551500206055510500602500500900501500000800000000500900000000540500000000000100555555150100555555150100605D52000000200002590000200002040000200002000000200002000000205056550500205056551500609D02000000505501000000000000000000A41A00000000141400000000141420001000141400A91600A41A00051500000000051700000000AA16000000009015000000005014000A000AA05500A4AA55501400144541601400144501051400144501001400144501001400148501001400147D00021000144501000000A4AA01000000000000007C000000440000004400000044C083A87C0022B2000012B100C00300000031920000000003005100FC7D000004710000042100000401000004010000040100008400000004010000FC01000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000A80900000700003200010000000000BC660600000000000000006656000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000E000000D000000000000000000000000000000000000000000000010BBBB8CB8BBBBB100000300FFFF0200FFFFFFFFFFFF00000000FFFF6400FFFF64005F0005006300000008003F00430049004B000000040009004D00500058006B00850000008A0000000100010009000100010064000100040001000500010002000500000005001400000000000A0000001900000000000A0000001E00000000000A000100";
    private static final String L5 = "555555550400075045140400963000410400895041100400540100410400559255110400546195410400B443407004000430011004007455024014005457D5110000400501600A00180041500500000014002000550644000000120013A02A00100001901500504955411400A08A99010400541500100400410468284100615558145900191D5414410001755414590029571817410009040010590019145117410059551414590059151514410001301014490085500014490045500504500085504055550049900C555500615050545500655005545500E5500014090065150090590005504454410001C0442459000750451404009630004104004950411004005401004108005692551104005461954104007443407004000430011004007455024014005457D5110000400501600900180043600600000014001000550644000000120011A02A00100001501500504555411400A08A9901040054150010040055555555040010011A4A5000581516455600460715455000401D15455600CA15C64550000201004456000645D4455000561505455600564505455000000C04455200211400455200115401015400211450555500122441555500181414555500195401A56A0039140045420059050054560001141175500000301149560000020000C0010200C001000080010200921180A8000022B2C21410B1561C0200161D3092001C0600861F5600BE1E0400BE170400BE110000BC1B0000BCDE0700BC1F00003C000200801F0000801F0200010000000000000000000000000000006000000000000000000060000000000000000000600000000000000000006000000000003000666666000000000000000000600000000000000000006000000000000000020060000000000000000000600000000500004044446400000000000040404404000000000000404404040000000000004004000400000000000040444004000000000000404044040000000000004044440400000000000000000000000000000000000000000000000000000000000000000010418A25000000000000040006000000000000000000000000000000000000000000000000000000000007000800000000000900000008000000000000000000000000000000000000001100080000000000040000000500000000000000000000000000000000001E000A0001000A0023001E000A0002000A0023001E000A0003000A001E00";
    private static final String L6 = "5555555575005415505520000440561500009819A82A20000005000020001808981900001407545520004A35509502005055541520005055541510005A15008412005454000420001010141500005014141520005014001A000010502610200054155055200057D55F55030003C00C002300D557545F750001802000040025912000550015115555550045404544050045514544550085550500550045C00500050011000560040021000080540091008566F40005004561550005054565050095650500050005004555550095054561550005856062050001802000540085491526550045C5351507000000000000005415505520000440561500009819A82A20000005000020001808981900001407545520004A35509502005055541520005055541510005A15008412005454000420001010141500005014141520005014001A000010502610200054155055200055555755010003C00C002300D557545F65005555555575000020080041004924084055004544555555001150115141005154115155006155014055001170014041000440011841000800002055002440A1197D0001405158550041415159410065590140410001405155550065415158550041219858410000200800550061528549550051714DC5410000000000000080030000BE0304003E7E0400067E0000067E84A8200024B2000010B1038001000380359207A6010000065400002600004400000000760400044604008043000080030400E7CE0500E7CE01000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000300000000000000000002050000000000000000030000000000000000000000000000004000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000001021840B00000000000005000700000000000000FFFF0000000000000000000000000000000000000000080013000800000009009F00000000000000000000000000000000000000000008000000060000000400010000000000000000000000000000000000000028000A0001000A00230028000A0002000A00230028000A0003000A002300";
    private static final String L7 = "54455551150001005500400060009E0007009000A60000005000AA03050000801503000055CD1573550055CC55735500560C82409500580E82802500680100402900580282B0250056018230950055CD5533550055CD5473550000C05402000050C0AA0006003000AA0000005000960005000100550040000450021640000150A9150000D1515515110051515515210001509910000001F0C03F000000000000000001FF00BC0000A5428A566A00955600545A00955600545A00A5568A066A0001F800FC030000000000000001F00F3C00000110981500009152551515005151651535000150A915000004500216400002005500400060009E0005006000A60000005000AA03050000801503000055CD1573550055CC55735500560C82409500580E82802500680100402900580282B0250056018230950055CD5533550055CD5473550000C05402000050C0AA0006003000AA00000050009600050001005500400054455551150001948005100000546A054000D45455454400645455454400005426044000003CF00F4000000000000000C03F002F4000A990A2955A00A51500955600A51500955600A995A2815A00003E00FF400000000000000000FC030F4000000466054000A45455454500545459454D0000546A054000019480053000811F0800801000008C1003008C100300800080A8801720B2000010B12FC00F00014938922140080021405800210908003F400F0000000000801E0000001000008C1003008C10030080100000811F08000000000000000000001000000000D0000000000000000000E00000008800000000000C000000880000000000000B0000000000000060000000000000000000000000500000000000000000000000007000000000093000000000000000000000000000000A0000000000000000000000000002000000000000000000000000000000000000000000900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001061646A25B8BB0C000006000800070000000700000007000000000000000000000000000400000000000800000000000000060000000C00000008000900A600A700A80000000000000008000000130000000D0000001300000007000400010001000100510000002D000A0001000A0023002D000A0002000A0023002D000A0003000A002300";
    private static final String L8 = "5555555555000054551500000051550500004044550100000041410400000000811400000040440000000041510100004556555555004156555555000541010055000100014055000000001500000001550400004044550100000051550500000054551500005555555555000000000000000000000000001000004000001004004000001011005000005044005800005001844900005001414500005041144400005006004000005008000000005006004000005441044000005041018000005041014900005044005800001011005000001004008000001000004000000000000000000000000000000000000000000054551500000051550500004044550100000041410400000000811400000040440000000041510100004556555555004156555555000541010055000100014055000000001500000001550400004044550100000051550500000054551500005555555555000000000000000000000000005554555555000400001000000401001000004404001400001411001600005400611200005440501100005410051100009C0100100000340200000000940100100000551001100000545000200000545040120000141100160000440400140000040100100000040000100000000000000000000000000000000000000000000000000000000000000000801F0000001E80A8001F20B2811D10B1100000001800309210000000800150008000000080100000801F0000000000000000000000000000000000000000000000000000110000000000001011111100000000000010111111000000000000101111110000000000001011111100000000000010111111000000000000101111160000000000001011111100000000000010111100000000000000000000000000000000000000008300000000000000000088005000000000708888880000000000008088888800000000000080888888000000000000808888880000000000008088888800000000000080888844444444444444444444444444444444444444444444444444444444444440856966050000000000000000000000000008000800080000000000000000000000000000000000000000000000090000001200050013000000000000000000000000000000000000000000000004000000030005000E000000000000000000000000000000000032000A0001000A00230032000A0002000A002300320003000A000A002300";
    private static final String L9 = "000000000000000000000000541555551500504900000000405555560900000050570400010050145800050000004000190050245000014051554000190000000000094052554000050040154000048001001000100004001500008015400100441500000100000000000000541501001500000000000000004001000000004001000000849045884800141088444400540000055400540010004500580000458500440000454500480010001500444004005400494004005400504014001500444054405500444054404500444068404A0054400400440084040400410044080400410000400100000000400100000000000000000050155555150050490000000040555556090000005055040001005014580005000000400019005024500001405155400019000000000009405255400005004015400004800100100010000400150000801540010044150000010000000000000054150100150000000000000000000000000000500000000000500000000021641122120005042211110015004001150015000440110016004051210011004051110012000440050011100100150012100100550014100540050011101550150011101550110011101A901200151001001100210101401000110201401000005000000000005000000000800000008000000080FE070000FE0700000084A8000026B2006010B1006000000600309286010000800150008001000080010000800100008001060080010600F8010700F8010700800000008000000033333303333333333333333333033333333333330300000000000000003003000000000000000030033033333333303303300330333333000000033000303333333300000300003033333333000003000032333333000000030000303303303333330300013033033033333303000030330330000000030003303303303033030330033033033030330303300330330300303303003003303303303333330330030000003033333300300300000030333333003033333303333333333333333333033333333333338063000000000000000000000A0001000000000000000000000000000000000000000000000000000000090000000500000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000037000A0001000A00230037000A0002000A00230037000A0003000A002300";
    private static final String L10 = "55001555550014500054000001400010640000001500150000050000450040151504000000001415000054500000100010400101540000405114500000500004040000000000050000055001500040055441000000005510140050010004040054500501050054404540150000411559000001500501000001014101040045114205050040514155410040510055000041400055510001004141550001000500550005110400050054510005050055111448150055011554210055011554100054100550000014000114010014000445450004040451510000152055400004565014000004111001010005010004010014500054000001400010640000001500150000050000450040151504000000001415000054500000100010400101540000405114500000500004040000000000050000055001500040055441000000005510140050010004040054500501050054404540150000411559000001500501000055001555550040405000410051845041410050545055100050144015000010104055540000405050550000400140550041040140410055144041010055040552450055400555480055400515440015440114000005400045000005004151110001014154140040054815100081151405000041044440000041000041400000070E0000070E000007000000000000000080A8000020B2000010B10000000000003092001C0C00001C5C00001C0C000000000000000000000E0000000E0000000C00000E0000000EE000000EE000000800FFFF00F100000020FC0FFF0000F0F0FF0070FF0FFFF007F0F0F000F0FF0FFFF0FFFFF0F9FFFFFF0F00F0FFFFF0F0000FFFFFFFFF00F000F0000FFFFFFFFFF0FFFFFF000F0F00FF00F0FFFFFF00000F0FFFF0FFFFF7FFF0FF0F0FFF00F00000F0F000070FFFFFF040F0F000300F0FFFFFF000F0F0FF070F0F00FFF0FFFFF0FFFF0FFFFFFF0000F000FFFF0FFFFFFF0F60F00F0FF00F00F0FF0F00000FFFF0FFFFF00000000F0F00F00FB0FAF0FFF70FFFFFFF0F00FF0000FF0700FFFF0C00FFFFFFFF5F00FFFF60666666BBCB069000000A000A000A000A000A000A000A00FFFFFFFFFFFFFFFF000000000000000000000E00130011000A000900050000008C0099009D00000000000000000000000000020004000E00050012000C0000000100010001006000000000000000000046000A0001000A0023004A000A0001000A00230056000000000009000000";

    //wizardry 3 legacy of lylgamon levels
    private static final String W3L1 = "4555685529003000140014000E005555590001000456690000009680910000002252910000001858910000A066569100555555555500A69114001400040268692900509064551900190580AA0200495280AA0200405220820800251400820000005080690200141AA0410A00661980590200000084AA12006100650064003100010000000C0021099800010025856800010061552900010055956900010095852900015001846800412801000000051165006400211525986000216451121600416551551500910051551500112551551500458591551900459551891500052851891500A144510115005144655565003000140014000E005555590001000456690000009680910000002252910000001858910000A066569100555555555500A69114001400040268692900509064551900190580AA0200495280AA0200405220820800251400820000005080690200141AA0410A00661980590200000084AA12004555685529001840190059000C4000004000034048022600004049215A00004058554A00004055655A00004065614A00005400215A00104A000040004144190059004845092658000859948445005059545545002440545545004449545545835161645546B0516554624500014A5462450028515440455D1451595559000006060000000000000C0000006E0C0000C4010000C40D0000E2010000600C0000F00000CFF60600DF620400DFF80100D8F8010003F38CA9C3F3ACB1E6F31CB166FB0D0000F871847B08C1847B0AC5840D000000C0000000000C000300200000000070003000002000000000006000002012000000000000020012110000000000002120112200000000000021202100000000000000111211450000000000000000000000008888000000000000C0008888000C000000000000000000000000000000C000000C00000000000000CCCC0000000000008800C00C0088000000008800C00C0088000000008800C00C0088000000008800B00B0088000000000000B00B0000000000000000E000000000000000000090FA000090BB11BB1CC11C6B000000000500010004000500FFFFFFFFFFFF02000300FFFFFFFF0000FFFF000000000000020000000100000004000500FFFF00000200FFFFFFFF0000090000000000000005000D000700120001000100000013000200010003000000010000000200000000000500FFFF0700000000000500FFFF0700000000000500FFFF";
    private static final String W3L2 = "5555555555DD5455454104B95015556021FF59550554200D0011614216D881544920550040094109140219927400150582249210D1001005584202C675554111580A0401A65414FF16040231830D0410802190C625306010340A55F07058002F5481CC1542CA14C5515501A3901553000012C030540090020D008214492F2100A194540CC1404085440C4122521656B2414414550000454958440D2F4954115441A84585955541004161111519CFD148455434A2416845C1142F59515505460049455558153A5165155545C63155150845CD016455C555100D5111081506894115031106554C040210001555000061005455454104A650155560217359550554205400116142167281544920550180054109140119A1740015CC82149210D1801005584202047555411158F70401A65414A61904023183730410402190A625105010346B55F07054006F5481C815426314C551550120901553000066C0305400900255555555551A0380208552610840281555C630105021510090889485551F1011451540A65112165143F4125604555000916165555000505844454601345211154D00305A513045A65654558151A65251155645015455455551014C55054251830055555155B0435404434500A250C540440015138100445D4515004058CC01F827A203FB27A37FF827A3FFDB97C6FF53C000FF1B2F00FF030FCDFF0FBF02FF0F4F00FF9F1FB6078F3F00070919B60758A15B475089A9431CAFB1C0FC1FB1CEFC0F00FEFD7F84FEF1CF84FEFFCF840000000000000000006000000000000000000000E0000000000000000000200000000000000000000000000000AA0000007000000000000A000000000000000000AA0A0000005000000000B00A00000000000000000C0A00000000000000000000000000AA0A0080090000000000000A00000000000000F0000000000000000000D0000000000000000000000000000000000000A00A000000A000000000A00A0000000000000000A3AA000000A000000000AAAA000000A00A000400AAAA010000A0AAAA0000AA00106CBBB116B5B6CB00000100FFFF0200FFFF12FC040050000200040000001C000200FFFFFFFFFFFF00000D00FFFF12006B001600020047000C000D0000001A00090010001100FFFF000013003C000300010004000A000A0009000D0001000A000B00010001004C000C00000000000A00FFFF1600000000000500FFFF0C00140001000A003200";
    private static final String W3L3 = "0555000151DD0040184106B95555555565FF02000000500D5100000000D85001000000005505000040025415000010055855000040005955010090C650550500100A5155150040FF54555500100D5555550100C651555505400A50555515402F5155555505CA5455555511A3595555556512100154000102514444501A2F15110111210C10555555150C1155555515B215545555550011505555552F1140555515A81500555515001000545515CF1400505555A214004055552F11000055150010000054553A1000005055C61400004015CD1400000055101100000050061100000011062114A04421005149455414000040184106A66555565565730200000050540100000000720000000000010900000040010400000010CC0800000040800500000090040000000020F70100000040A60400000010730500000000A601000000406B00000000406F01000000056304000000112009000000656610015400010205550001511A1411119446614944404448C608000000000004000000401F0500000050A60400000050F40400000040000500000040000800000000010500000010000500000010A60400000040A60400000010010400000010010500000000830500000010B004000000540004000040440008062851485D5452111545CC03062DA203002CA3000020A3000090C60000C00000002000000000CD0200B0020000400001001CB601003800000010B60000A05B000080A90000A0B1000010B100000000000070840304CC841306CC844A000000000000000060000000000000000000000021000000000000000000030000000000000000000000000000000000000000000000000000006000000000000000000000B000005000000000000000000000000000000600000000000000000000000000000000000000009000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000000000DC000000000000000000EF00000000000000000000800800006000000000000010BBB166BB6BBB9B00000100FFFFFFFF05005EAC030000002B00F0ADCA000300FFFFFFFFFFFF000000000E000E000F0000002300030000002900260008000000430044004500000000001300010001000B000400030000000B0004000E00010001000100010000000C00000000000A00FFFF1B00000000000500FFFF0C00140001000A003200";
    private static final String W3L4 = "5555555155DD5550502057B9553F4B2114FF30505025240D7F54951514D86540940657001554551557028514551514051004460400001410112614C6150C5409570A1914411057FF94048807140D1215142024C610119205140A95155514572F5555055255CA64A2505055A301004040811264A21010A60210C48C64002F09761556010C5515D550690C15C5846A65B241048161010004158052002F410100C001A89545416049008595914545CF8145194401A244955154002F11911546010045455151653A2988155169C64561814901CD0000600400101196910580062A41801468062AC1409651001196911521005550502057A6553F4B2114733050502524547F54951514726540940657011554551557018514551514CC100446040080141011261404150C540957F71914411057A69404880714731215142024A610119207146B95155514576F55550552556364A25050552001004040816664A21010A60255555551551A083123190061825D855540C6554535545A004531915A591F1041605840A64205902400F45000007040006551105852006165645151016051065140005265141500A64464855140A65151545459010A6245545A015158605240830000180100B08465640160004A1020059A004A309065945D8465644548CCE05F20A2EF5F20A3EF4726A3EF7F96C60778C00000782000070000CD677FB602677F4600677F10B6667F3000437F10B66F7FA65B7F7F86A97F6FA0B1000010B1FF030800FFC77F84FFCFCF84FFCFCF84444404004004404044440000040040004040000000030400004044400000000004000000004090000040444444040040000004004444440400404444000044444444444400005000044000000040B00000004440000000400000000044440000004000000401844400000040444400004440070000400000000004400000CD40A00000000040000000400000000000400000004000004444444444004044444400000000000040444404E0000EE0E0004000E000E0F000000060400000EE0000E00E0E0F400200001061153B6BBCB36B0000020006000400000001005900040004000400FFFF00000200FFFF010004000000130000000600010007005100070020000600FFFF4A000B001D0022000F000000000005000100010007000A00010003000E004B000F0002000100090011002000000000000A00FFFF2A00000000000500FFFF2000140001000A003200";
    private static final String W3L5 = "00800A2600DD0080221600B900802A2600FF0080152A000D0080192200D80040552A00000040551100020000501100050000550900000040AA0400C600006905000A5515204055FF0641454A440D5401455640C6A4191000510A00145529552FA401000055CA54644C6949A346061180801255554255550200401565002F00405569000C00406969000C0040A95500B200401A55000000400254002F0040228200A80040225600000040045400CF0040544100A200409154002F4518511480009A590585553A1A98514492C64A44514449CD4A04454480101A42908440061A20955450060525556411000040166900000080222A00A600802A2600730080152A00540040192200720040552A00010080551100010000501100CC0000550900800040AA0400040000590500F75515204055A60641464944735401465540A6A4191000516B00145529556FA4010000556354644C69492047061180806655554255550200800A26001A0050451900610050551A00C600505A1A000000506A15001F0050451500A60090001500F40090882000000090881500000010011500010010551000000050141500A61146140560A666564161950106661491A40112512851928312411111A0B086102421900006482515940041491559445D0090451A00CCFFF32FA2FFF72FA3FFF72FA3FFD79FC6FFD3CF007FC02F007F830FCD7F93BF027FA04F007F8C1FB67FBB3F001E3F18B61E8EA85B027F88A97E7BA9B11E7818B102780800C2FA7B84F0FBC384FFF3CF8400050008600010800000000000086606008000000700070866060080000700070008000000800000000000F80E000080000700000A8800002080000050000008000000890507000000080000008000007000000800000080000700007008000000800000888888080000008088880B00000000000000000000000000000D0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000C00000000000000000088888808400000808888106BBB2CA516B1BB000006006A000000FFFF3100FFFF05000000000005000300010000003B00090000000000650000002C002F00FFFF050000000000070001000600490032003C0000000E000A00000001000B00480001000000000005000000070010000B0002002000000000000A00FFFF2F00000000000500FFFF2000140001000A003200";
    private static final String W3L6 = "0510055455DD1414110500B90005505000FF44100150540D4515144001D8150510045500460089419002003554905105A601050454005005501008C605101504140A5015510104FF46000428400D0050001090C656235101400A05650401022F0910050402CA4041140054A354554105001200055405080241050041042F45411511050C11511104040C0444411545B218611515140005415144852F114144110CA85110011504005151511010CF2151054544A221110051442F11461154100051141554103A5154141440C64550441000CD140141150A105054041100061511104514064500114014005351416404001414110500A60005505000734410015054544515144001721506100455014600894150010035549051CCA601050454809005501008040510150414F75015510104A64600042840730050001090A656235101406B05650401026F09100504026340411400542054554105006600055405040205100554551A5001401041615150454441C644540401410001515045111F4654450505A64150145151F44410510443001444400541005454140444014854411151008808401451A64451041544A61445051544012415050550011114110440834540508502B014154104000045044411490011400410455D54541019C1CC000020A2000020A3000020A3000090C67200C00070042E00730E0ECD03C0BF0207C043003F8011B63F8031001F8013B61FC0A35B5FC08FA940C0AFB103C01FB100C00F0000807F840080CF8400A0CF846666666666666666767766666666666666667677666666666666666676776666666666666666666606664F6066666666666661660060666066660680006600600600666606000066666666666699090000506666666666999900000033666666669609000000336066666696090000006B6666776796990000046066667767909900000E60606677679999096266666066666699999909666666666666999099666666666666669999996666666666666696D900666666666666669649006666666666660696A90010C1BB9556BBB0BB000004000500FFFF0200000000000000010000005F006400000017B10DB1460000000E000D00FFFF3F000D0001000000000000005A00600000004600460046000000130000004D000D000D0001000000000000000A000A0000000400040004003400000000000A00FFFF3E00000000000A00FFFF3E00000000000A00FFFF";

    //wizardy 2 knight of diamonds levels
    private static final String W2L1 = "5555555555DD5455455515B95855856A00FF14014005000D5441055114D85405005114005001A10500028040AA0624056042100400005455205415C654552054150A4040104401FF0041AA56250D0001655500C664240155000A20110110002F2014014400CA1014415905A304010174151254554555150201000000002FA5AA6A00450C190051154A0C0516521045B205505036400005405010452F159455214AA89556021845000550061945CF0180A22800A205100619462F555002184C0055545509543A5550510055C6550050015DCD5541591555105501503454060541540440064500500140000100000000005455455515A65855856A00731401400500545441055114725405005114015001A10500018040AA0624CC6042100400805455205415045455205415F74040104401A60041AA5625730001655500A664240155006B20110110006F20140144006310144159052004010174156654554555150255555555551A000000004061A9AA1A4051C606405485520081851444511F0114540D60A60110144451F4056555885200A5950046510001944146510100A0280A40000184418651A61594000653A61555550255011554144055011500544057835550564555B05500140D550041101501500011005400505D0000000040CC000020A2DE0326A302FB26A310C396C68003C00080C326009CCF06CD9CFFB60280FF4600803F10B6003F3700803F16B6001FA05B000080A90400A0B1040110B104200000000070840000C0840000C084050000000000000000000000D00000000000000000666666000000000000606660660000000000006066660600000C0000006066660600000000000060006006020000000000600060360000100000006066663600001000000000000000000B0000000060666600000010000000606A6630000010000000606066604440000000006068666066000000000060606666660000000000606966666000000000006067666666000000000060666666660000000000606666666600000000000000000000000000000060661615C6BB2200000001000100010001000000000002000100FFFFFFFF76004600280000000000000007000A000D000A00000000000A0002000100000034000A000A0000000000000009000C0009000600000000000B000C004D0001000C0002000200000000000000000000000A0000000000000000000F0000000A00000000000F000000";
    private static final String W2L2 = "5555555555000410545545000060004414005621551111004006441411000401504515820002840500A95546555002000481140200000801501900855905204058A90401000518FE049150606100555514010182062455541800A80A161110839A29445515A05A2900100185A80A681001000624140011AA05000100001811504524108111901111650185540104612B4550154164025155014144176150511155004150024155019556654455C64150554414A14150150429C6A569151215CD412005411450896201455026A55A01010400514541104500A146511440025145014014C5A55A6505418189A2014400CD0410545545500060004418815622551111004006441411000401504515B80002840500005586555002000441140200B8080150190000590520405400040100051400049150606100555514010100062455541400A80A151110065A29445555A99A29001001BCA80A6410010006241400110055555555555001400000404704541109444E046444445920215500415841115445105952545540105187185494445500109440505500A55519515500105415114500105405414500695A85444500104841104500A29840115400A956400041835451104451B0585114055000545100104500A9565951505DA2680011404EFF004087FF2040467F0076FE3F0006443F0056463F0030883F38404FBF7000A63F6000483F7C40493FFC22883FFC4047FF7040527F6080A97F00A0B17F0010B1670000007F0070847F00C0847F00C084000000002222222222220000000A2222022202220000000B222222220225000000092222222280240000000022222222022600000000220222222222000000002202002222220000000000000020222200000D00000300202222000000000000002022220000000000000000022200000000000100002222000000000000002022220000000000000220222200000000222222222222000000002222222222C2007000002222222222220000000022222222222200000000F22E222C222200000000222222222222106566B6BBC12BBB00000100000002000200020002000300FFFF29000300FFFFFFFF0A008600FFFF00000200000010001300040000000400070010000000010047000A00820087000000100000000300130010000000090001000A0000004B00010001000B0001000000000000000F0000000A00000000000F0000001400000000000F000000";
    private static final String W2L3 = "1124111514DD5111849141B90045504055FF45554155010D0100000050D81414142814000400001444020114142840052400100018004981614141C644004100850A4141494281FF24000400400D0128141450C604140008000A01281414502F2400080004CA4155455511A311445054551241114041040200145100012F14004514100C40001000100C4000540044B245005400040041440054042F5444005418A84100840054005400540014CF0144094450A214448045502F41005400540054004800143A4154005454C65454006414CD4100440004105400540054060110048200061001141000001151554040005111849141A60045504055734555415501540100000050721414142814010400001444010114142840CC2400100018804981614141044400410085F74141494281A62400040040730128141450A604140008006B01281414506F24000800046341554555112011445054556641114041040211241115141A0045144000610540110504C610000400040010001500111F1100150041A61011001541F41511001506001000210055001500150005010051021154000511601114A61000150055A61500120005011015001555011515002905831000110041B015001500150000048120400044000504005D4454151050CC000020A2000020A3000020A3000090C60000C00000602000006000CD0006B00202064000801F18B6801F3000000618B60006A05B606080A96060A0B1000010B100020000000070840000C0844000C08401000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009000000000000800800000000000000008008000000000000000000000000000000000000000000050000000000000000030000000000000000000040000000000000000060000000000000000000000000000000000000000000000200000000000000007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001061B6C2B9000000000002000400030003000A000A00FFFF0000FFFF000000000000000000000000000006000C0000000D000B001900010000004F0000000000000000000000000000000100070000000D00080005004900000001000000000000000000000000000A00000000000F0000001400000000000F0000001E00000000000F000000";
    private static final String W2L4 = "5140550554000141001044000100440140004404114410000400000500001011040541825000405101A90510504105004044405101000401411010850012004401A91012040115FE4045010054004140141400820000010050000411441004830140050001A01044114154850400414100004110554505AA15414410041810044540508115041144100141114410412B5511440141020544501004171545100400000415004110014440415414C65045040544A15015045140C60040105401CD4110145405500551511005260551541015001104004101001444104104024510440401C55110014000811541001010CD0141001044500100440140814404114410000400000500001011040541B85000405101000510504105004044405101B80401411010000012004401001012040115004045010054004140141400000000010050000411441004060140050001A91044114154BC04004141000041105545050051405505545045101104414704411110144E0541041144205004114450415504514050520111140441874511040140004105001004001150101505005411410111005405411410001010045500001004055541004154144441004114154445830401405040B005114410010011041141400014440010405D45100004444E0006408700064846021870FE083800440A085046000030880200404F000000A60080014810804149100020880000404780014052400380A94002A8B100001AB180010A00008470840005C0840000C2840111001001101100101100110100011011010001011101001100100100111101110A1001001100100101110010011111001001001001000100110100011110010B110100C0001011100000009210110010010010001001011000B001031001BA0100100100010411010011101101000000101100101000000010110010001010101101001110000100111011010A111001010011100011001011111100100000100010517811A0100100100100116110010011110001B011000000101111011100101111110000119011BCBBBB270B000000000003000500FFFFFFFFFFFFFFFFFFFFFFFF00000500FFFF000000000000000000000E001200010031002D002F00300048000A000A005000000000000000000000000D0001004A0003000100010001000100040002000100000000000000430000000000060000001E00000000000F0000002800000000000F000000";
    private static final String W2L5 = "545541551500545641951500104041010400305400150400541400141D0094A5825A16820050650500A91041574104004001414001005C05575035855501184055A95C05D55035FE4001414001001041D541088200505905000094A5825A16837414001415A0105400150C851040410104005456419515AA0000100000180505DC404181554754445D0105095581412B0944554580024505444045174519009045005558009454011558C59D50C600606C1400A10050642400C615D84D9550CD555800945450451900904526450544404500094455458000050955814102D545544457C50505DC4041810000100000CD545641951550104041010481305400150400541400141D0094A5825A16B80050550500001041554104004001414001B85C05575035005501184055005C05D550350040014140010010415541080000505505000094A5825A16067414001415A9105400150CBC10404101040054564195150054554155155000000400004741013750504ED5111551572041425560504102515511605251011150518751060064510015160025550005567125540000141B0500000014190500000556532554001516002555005106006451005101115051830251551160B0414255605000751115D1550041013750505D00000400004E00004087E0794046E47972FE0009004460695046168036881680464F060006A61E89074800044049000620881E89474706004652168086A91680A6B1606910B100090000E4797284E079C0840000C08466666666666666666666060007006006007000610608070060060070006006000700600600700060767707006006007077670600000060060000006006000066666666000060060B00666666660000600600006660A666000060666666660662666666666666666636646666666606000066650666000060060000666666660000600600006666666600006006000000600600000060767707006006007077670600070060060070006006090700600600700060060007006006007000606666666666666666666610C6B15533330000000004000500FFFF060075000000000005000600060006000000000000000000000004000800010000002A00010000001100010010000F0000000000000000000000090009004C0000000B00010000001100050007000C0000000000000000001E00000000000F0000002800000000000F0000003200000000000A000000";
    private static final String W2L6 = "5515400154005205555505005F41405501005480005009004082400500000050555101824002005901A95056555005000054455615005051050004855600100104A90050595505FE000000554C00005400403682405C55C000001610000014830000005505A05614547551850055577564000055151491AA394000000018A1568100108105144100140105954210102B451481201002450400941A17050500211000150C401300011504500140C60510700174A10111100440C60101010254CD0101010105500105024145264114014144000544014148000544016B50020101051014C501024C44A5810101400494CD5205555505505F41405501815480005009004082400500000050555101B84002005901005056555005000054455615B8505105000400560010010400005059550500000000554C00005400403600405C55C000001610000014060000005505A956145475A1BC0055577564000055151491005515400154500E1000004047A8552000444E01451000452041A510044441114510084452110100A546874101400844000503D004400005015400500001045C005D004004040150004040800055004040404041004081405051001045401051830151401052B00151C01A5400404001044500800023526A5D40001001654E0000408700074046000770FE80C7034418C7534618C0338800F0434F1C3800A61CF00748C0F34749CFE327880F0F46470F0F4E520F8F87A9278FA7B1608F17B1608F07000F0176840F7ECC840F18CC84C20000101111111111B1CC561410000000000011000010000010111101111011100000B01100001110011000000000000011100110111111013E03111011101111B1000000111000000000000011111110001011B110000000101011110000B00000001000001100001101000010000011110000000080100000111100001111C0000000010000001191000000100111000011710700101101100000110B0000101101100000A0101100000011111011B100B000000000000000071000330000111111711711013B50C1B64BBB6B050B000000000500FFFF0100FFFF70000000FFFFFFFFFFFF06000000000000000000000000000A000100090071005D000000570059005B0000000100000074000000000000000A002F00090001000A000000010001000100000001000000040000002800000000000F0000003200000000000A0000003C000000000007000000";

    //black stone
    private static final String BSL1 = "55555555550051554001AA0084088001450090089441AA005008A0511900A52A40152600040510951400441500512A0001105510AA004055151A55004451005555001548904610004845014451000411015456004814041804005614005954004A4180584500544500525500025041611400015005201400010004005500110145550100451541555500A51565150000010054055500515515554100414855505500514811410100954400115500958040150000911451180400554410659600410014018000550411551500410605111500414615115400190054554500051055A4540009501050550005101010010051554001AA0084044002450090045442AA00500470521900A52A40162600040510A51400441500612A0001105510AA004055151A5500445100555500154890461000484501445100041101645500481404280400561400A954004A4180A84A005445005269000250416124000150052014005555555555000000014055004440915540005145505555006945590540000000654155005455455A5000105215545500146244504000251140445500292050054000244514064100251144996500100045006000154144A54600904141844600905145046A000600555561000144152565000228045455000104044440000000090000000000080002000C000000000006002800000018000200180000001800000000000000182000001AAC0400000C0800022C0000080C0000083C0000001000000000000040380000003800000100000000000000022B000000000000000000000000800000000000200000007000000000000000000000000000000020020000000000000007000000000000000000092002000000000000000000000000000D000000000000000000E0EE0EF1000000000000EEEE0E000000000000E0EEEE000000000000E0EEEEEE000000000000E0EEEEEE00000C60000000EEEE0E0000006000EE0EEEEE0E000000006000EEEEEE0E0000660660000000EE0E0000006000A00000030000005400060000000000000000000010CC1BB6BBBB1B8500000000FFFFFFFF640002000100FFFFFFFFFFFFFFFFFFFFFFFF03000000000000000000000000002D0009000E00000001000800130018002F000A00000005000000000001006800050003000D00010001000100010001000100010000000100000000000000080000000000000000000F0000000600000000000D000000";
    private static final String BSL2 = "555555555500141505150000540544100000441444450000500544451000005044405000900655540100451805001000845851155000860811260500441500505000554515455000446514150400505511445500210200804600011044414500144555854600140540414500091045814600204221414500094140400000094041010000A96A15500000011045000100111115505000111140114100011000114500615A05111500251000590500651A45650000214045111300195001400000450344411400114454159800551541548500596501109800014000500900596550109800511550548500114450109800141505150000440444100000541544450000500544451000005044405000900655540100451905001000845851165000860811260500441400505000554515455000446914150400905511445500210200804600011044414500144555854600140540414500091045814600204221414500555555555500421010104000025050004000AA5A0514400000441140400044440514540044045044500000044044510098564144450019044056410099465119400008505184440006540010400051015110450004115505660055451055610056590004660000100054420056191404660054051455610004111404660000000000000000002A000000000000003C300000BC3002000000000028800000006004002A0000008000000002800D0000800D0000000800140001001400020000000000140008001780000003000A000000EE0E00E0EE0E00310000000000E00050001100000000E000000E000000000000D0E4EEEE000000000000E000000E000E00000000000000EE00E000000000000000000EE00000000E0E0000000EEE00000000000000000E00000000000E0090000000000000000E00000000EE000000E70020000000000000000080080000E000000000808808A07000C00E0000808808800000000000008088888800C00000000080888888C00060000000808888887000C000000080888888000C0000000080888B8870C0C0B034BB2B85B21C090000630000000300FFFFFFFFFFFF0000000000000000B5FBFFFF0100000000000000280000000A002A001D00240006000000050006002C0000000F00000005000000050000000B000100010001000200000001000200040009001200000001000A00000000000D0000001300000000000C0000001B000000000008000000";
    private static final String BSL3 = "555555555500005400609A00040010699A0054455591A6000405505A9600545401150400400011619A00441405842000540000892000001110699A00554014248A00010010258A0051510554550000000001050010410504450050C14545140011D0D041410005D01517C30010051551C30010415C71C50041001291A60041445192A600154491906500015110A06500154010144500011415511400511540140400154051A4A60001415115040001140194A60001554410040005411491AA00511404454000511404405100015510143D0051444144D1004554D14757001144FFFD55005145D4545F0001D0F7DF3F00005400609A00040010699A0054455591A600040550599A00545401150400400011619A00441405842000540000892000001110699A00554014248A00010010258A0051510554550000000001050010410504450050014545D700111010417D000510D5D43C0010C5D55D3C001041534D3500555555555500108044645900105194A46900055128645900401404645900051004455100004545144500540510054100055014A96900405054054100004500A56900401511044100411045A4690014054211500014050150540040D5074570001451D051470011550411550004114040550054D1C515540000040104700000F1060001F00F0040C00F0000800F00002200000040020080180000001800002000000008000000000000000240080000000000002000000802000002520000000408000800000000D6000002000000000000000800006003060900000000000006666000000009F0000060000600000000000E006A7666000000009000000002200000000000000000000000000090000000111111000000000000C0B1111000009000000000111111009000000000500000000D00000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000050BB8BCCCC6B1BB100000000FFFFFFFFFFFF0000FFFFFFFFFFFFFFFFB2FB0300650004000100B3FB00000000300038003200050000000000000000002C0012002D000B000A002C000000000001000100010001006A006B00660069000400070005001100060004001800000000000C0000001E00000000000E00000028000000000008000000";
    private static final String BSL4 = "555555555500000060504A000000100005000000450050000000000500000000504400000000401045000000544400005455004801005455504845004045510400004544005404000000540400005A01000045000004504105005855050141001004005100000569514054001569500104001500001404000100A2A21A00010091101400010041100100010011111100010011141100010041411000010001004100010005254000250004554400110004541000511004411000110505010100110511100100450011104000451411154500054918100000655114450500490004451400091111410000091121011400000060504A000000100005000000450050000000000500000000504400000000401045000000544400005455004801005455504845004045510400004544005404000000540400005A01000045000004504105005855050141001004005100000569514054001569500104001500001404005555555555000040A4A84A000040240445000040104440000040444444000040044544000040501044000040004050000040410950000900411551000000011544001404411044004441414040004441044440001140040450001145444551004112060440005A144551410012004111450042444410400042444800450000330400003B02000039000000330C0000430C0000070C0000070000000000000002000000800300008203004F0000000F0100001000000000000000000000000000000000000C00310C0C00310C0C00888888F8000000000020888888880000000005008888888860000000000488888888000000000000888888880000000000008888888800000000000088888888000000000000888888880000D0010003B00000E00000000000000C000000000090000030000000000000000000000000000000700000000000000000000000003000000000000000000000000000000000000000000000000000000000000000000000000000000030000000000000A0000000000000000000000000000000000000000000000000B07B66668411BBBB0000FFFFFFFF020004000400040004000000000003000500B1FB66006200FFFF00003B003E00080010000E000B000D0000000500000013002E002D004100420000000100010003000500050004000300000001000A0009000400050005000100330000000000060000002700000000000A0000002C00000000000D000000";
    private static final String BSL5 = "555555555500000090405000645506154000001500181000000C00080000000C001110000015001140006455060800000100000800005455254841005A5501041000555501554500505551110000505501245100505541011400A0AA0A14000010114A421400A0AA0998140040554821000010110904180085009201110045005141000045005119400045415155100085BD6141100045415115400045005141000045005155000089005255000001004095440015005441180011001400000011005458010011005404910011005400850011115584450091995944000051555144450011005424450091965608A500000060405000645506154000001500141000000C00040000000C001110000015001140006455060800000100000800005455254841000A0000041000050000554500000050110000000000245100000040011400A0AA0A14000010114A421400A0AA05981400405548210000101109041800555555555500218054404400114054104000114054095000515054154400616F58104400515054055000114054104000114054154000228054154000000050155100050055104500040005004000040015564000040015416400040015406100444415615100646616114000545514515100040015495100A4A51542690006030000060300000000000000000000200000000000000000000000060300000603000000800100028001000000000000180000001804000000000000030000001A0000F81806000018060050180000000000000035000000000000000000000000000000F0FFFF000040000E0000F000F000003000000000F0D0F0000000E0000000F000F000000000000000F0FFFF0000200000E0000000000000900000000000000000000000E000000000000000100000700000000000B000000C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000A000000000000000000080000000060080BBBB1BB1BBCC5200000000FFFFFFFFFFFFFFFFFFFF0400060067005D00FFFFFFFFFFFF020000000000050044000000450059005E00010013002D002D005700000000000800000000000100010001000100010001000800000005000500010067006C00030000003600000000000C0000003600000000000E00000036000000000011000000";
    private static final String BSL6 = "5555555555004551650154008A021142440080008AA24A0064508A524500900012214A00922A55114500551014A0AA00002A281011001000489415001054106404001015554408005065544415005401005555000052140000005A41540000002020100000005165140500004509145500004191100105001190004000005565A919A5000151A114A5004111055599000501A1048100D501A55695000951011000000151455055005501150041006502A56542006501A5A55500655801A0410005108524000021144A555500211500555500515865555500114805515500191801115500991905105100A109641910004551650154008A021142440080008AA24A0054508A524500900012214A00922A55114500551014A0AA00002A281011001000485426001054106404001015544408005065554415005401005595000052140000005A415400000020201000000051651405000045091455000041911001050055555555550004240010400055556A4669004054284569005044415566004140284160007540A9556500425400044000405411545500554005405000594069595000594069695500191A01685000014421094000088552555500480540555500145659555500045241545500064640445500664601445400680259064400000000000201080000000A00080000000000000004510300000000004000010000000000004000000480020000800000C0260000C0060000000000000404000000000000010000001800000008100000FF000000000000000041000000000000000000000003000000000000000000000000000000000000000000000000000000000008000000000000000009000000000000000000000000000000000020000000000000000000060600000000000000000000000000000000000070000000000005000000000000000000000000000000000000000000D00CB00A00000000000000000000000000FE000000000000000000F0000000000000000000000000FF00000000000000000000FF000000000000000000FFFF00B0BB11C2BC6666960000FFFFFFFFFFFF050007000200FFFFFFFF610006000600060006000600000000006C006200760009000400080000000000630010000F000C0007000200000000000100010001001300040004006E006D0005000D000D000D000100080000003E0000000000120000004400000000000E0000004800000000000C000000";
    private static final String BSL7 = "5555555555000100000000008195000000004114000000000181000000001185000000001505000000004248000000005419000000002A410000000001910000000065190000000000180000000000100000000000100000000000440000000000440000000054440000000088440000000045451500000019120100000019110100000059210100000059490100000019440100000009500100000045000100000001140100000041100100000055190100000055900100000001940100000001940100000001940100000001040100000001A40100000001A40100000095A50100000051A4010000001184690000000100000000008195000000004114000000000181000000001185000000001505000000004248000000005419000000002A4100000000019100000000651900000000001800000000001000000000001000000000004400000000004400000000544400000000444400000000454515000000555555555500864400004000464400004000564800004000565200004000065100004000025400004000114000004000004500004000104400004000554600004000156400004000006500004000006500004000006500004000004100004000006900004000006900004000596900004000146900004000046216004000F1000000F0000000C1000000E00000006100000001000000000000000000000000000000000000004000000040000000000000000000000000000000A0000000800000002A00000080000000000000000090010066666666666600000000D66DDDDDD66D0000000066DD6D6DDD6D00F00000D6DDDDDDDD6600000000D6DDDFDDD66D000E7000D6DDDD6D6D660000000066DD6D6DDD6D00005000D6DDDD6D6D6600000000D6D6D66DDD6D06000A00D6D6DD6D6D6D0F000000D6D666666D6D000B5000D6D6DDDD6D6D00000000D6D666D6666D0000000066DDD6D6666D00000000D6DDDDD6D66D00000000D666D66D6D6D0000000066DDDD6DD86D34200400D66D6DD6666D000000006666D6DDDD6DFF000000C76066666666C0CCBB36B6BB5B6A0000FFFFFFFFFFFF60005F00070008000700FFFFFFFFFFFF5C000000070000000000000000000000650067000B000B000A006900820074009A0000000B0000000000700065006F000500050004000800130001000100010002000000010000004B00000000000E000000520000000000080000005200000000000A000000";
    private static final String BSL8 = "55554155550021220180050021220180D100212201600600212201108000212219218000212215620600212201A09100212219A00500555565555500000801010000555501555500020066144500000010162000000000002000000200951500555501951500555501020000555501022500565542144500555545443900010044551200A9AA46554500010044555000A9AA4681A000010064555000A9AA46554500010044551200555555513900001806010000001409060000095406014000015455682100015445415100015445415100015645800200015445454100015445454100015445482900095446014000212201800500212201809100212201600600212201108000212219218000212225620600212201A0D100212219A00500555565555500000801010000555501555500565566144500555511162000555501002000555501951500000200951500000000020000000000022500020042144500555541555500555511514E00000051954400AAAA51555100000051155400AAAA51206800000059155400AAAA51555100000051954400555555544E000086410000000049820100005680410050005500155A4800550051505400550051505400550211A04000550051515000550051515000550011524A0056805100500014800F0000860C005581080000400800450008000050080050C7080000460C0050C00C00C2200200C22002009200000001210300007607001070030029010000106007000076070001610200920000000000000A000100000800000000000000000000000000000010000000080000000000000000000000000000000A010000030000000000700000000000000A03000000000008000000000000000000000000000E00A04800002A0000017000080090010001010061050C030B0001000A0000000F000000000000000000000D000A0000000000009000000000000000000010000000000E000000000000000000000000000000010A0000000000000000000000000000000000100000000A000A0000000A0000000000704BCBBBB66666660000000081000000FFFFFFFFFFFF5C000000FFFF08000800080008000800080000000A00800000007E0000003C006A000000AF000A0004000F00040009000C00000005000A0000000100710001000500000001000A000F000F0004000C0009005600000000000A0000004E0000000000130000005D000000000008000000";

    //return of werdna
    private static final String WER_PYRAMID_ENTRAP_10 = "55555555550054555555150000000000000040555555010000000000000000545D15000000000000000000405501000000000000000000105400000000104000400000001400000000000000000000405501000000000000000000545515000000000000000040555955010000000000000054555555150001000000000005000000400005000000400045000000440045001400440045040040440045040040440045440044440045440044440045C48444440045444444840045440044440045440044440045040040440045040040440045000000440045000000440005001400400005000000400001000000000054555555150000000000000040555555010000000000000000545915000000000000000000405501000000000000000000105400000000104000400000001400000000000000000000405501000000000000000000545515000000000000000040555D5501000000000000005455555515005555555555000000000040000100000050000100000050001100000051001100050051001101001051001101001051001111001151001111001151001121311151001111111171001111001151001111001151001101001051001101001051831100000051B011000000510001000500500001000000505D00000000400000000000FEFF0700FEFF0700FEFF0700FEFF07001E8007001E8007001E8007001E8007001E8007001E8007001E8007001E8007001E8087A91E80A7B1FEFF17B1FEFF0700FEFF7784FEFFC7840000C08400000000000000000000000000000000000000000000000D000000000000000000003000000000000000000090000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020080060070000C000000000000D000000B000000000000000000050000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000A00000000000000000004000000000000000000000000000000010BBBBBBBBBBBB0000000A00FEFFFEFFFEFFFEFFFEFFFEFFFEFFFEFFFEFFFEFFFEFFFFFF00000000000000005E015F016001610100000200040008000C00100014000000000000000000020058025802580258020100010001000100010001006400C800000000001400000000000F00000023000000000005000000000000000000020000000000";
    private static final String WER_CATACOMBS_9 = "55555555550000000000A000AAAAAAAA5A00AAAAAAAA51000000008052005555555551005555554551000500004A5100A5AAAA4551004555154551004501004551004561154551004551AA49510045A1004A510045515545510045555555510085020080520045AAAA6A5100A5AAAAAA9A000A000000A00055555555A5005555555595000100000020005555555526005555555526000100004028006155555A2800615555592800210000522800A11440522800A11440522800A11400522800A19455592800A19456D92800A10400402800615655552A0061565555260021000000200059555555950069555555950000000000A000AAAAAAAA5A00AAAAAAAA51000000008052005555555551005555554551000500004A5100A5AAAA4551004555154551004501004551004561154551004551AA49510045A1004A510045515545510045555555510085020080520045AAAA6A5100A5AAAAAA9A000A000000A000555555555500555555556900555555556500000000004800555555954900555555954900000000104A00585595164A00585555164A00080080144A00280590144A00280590144A00280580144A00286555164A0028A555264A00280100104A83985555954AB098555595490008000000480056555555655D5A5555556500FFFF0F00FFFF0F0000000C00FFFF0D00FFFF0D0000800D00FFBF0D00FFBF0D0003B00D00DBB70D00DBB70D001BB00D00DBBF0D00DBBF8DA91B80ADB1FBFF1DB1FBFF0D0003007C84FFFFCF84FFFFCF84000000040000000000CB000000000000000000DC5100000000000000000000000000000000B00C0000000000000000C00D0000000000000000000000000000000000CB000000000000000000DC00000000000000000000000000000020005E0A0000000000000055F0050000000000000005000000000000000000CD0000BC000000000000BC0000CD0500000000000000000000000000D00C00000000C00B0000C00B00000000D00C0000000000000000000000C30000000000000000BCBC0000000000000000CD10B1BB0000BBBBBB00000B000900FEFFFFFF00000000000000000000FFFFFEFFFEFFFEFF7401750100001300130018000000000000000000000000003200620168016E012700270000000C0009006500C900788800000000000000002C01580258025802040004002800000000000F00000037000000000005000000020000000000020000000000";
    private static final String WER_LAND_CUTS_8 = "5551515555000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001100000000001100000000000100000000000100000000000100000000000100000000000100000000000100000000000100000000000100000000000100000000000100000000000100000000000100000000000100000000000100000000000100000000000100000000000100000000000100000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005555555555000400000040000400000040000000000040000000000040000000000040000000000040000000000040000000000040000000000040000000000040000000000040000000000040000000000040000000000040000000000040830000000040B000000000400000000000400000000000405D00000000400008400000000E00000015000085800000306000000241010004240400001006008181020021000100C2150200D010000011080000106381A9E048A1B10E3112B13400000040C471848030C0848400C0842DCC3CCCFCBC9A080000E5CCCCCCCCAB89777707C0CCCCCCCCAB89888807C0CCCCCC00A0999989070000CCBCA000AAAA8907CC0CC0BBA00A00A08907CCCCC0BBA0ABAAA08907CC00C0BBA0BBABA08907CCC0CC0BB0ABAAA08957CCC00B00AB0A00A08917CCC00BBB0A00AAAA895700C000BB0AAA99998907C0BCB0AA0A9A88888907C0BCB00A009A0000890760BCB00AAA9A90088907C0BCB00AAA9A90088907C000B00A0B0090088907C0B0BB0B00AB89088807C0B0CCCCBC9A7847770700C0CC7C77070000000010B1BB2B2222B2BB00000A000800FEFFFFFF00000200000001000200030004000900FEFFFEFF00000000050000003A00000000009500010001000100010001000100760177013B000000090000006600CA00AA88030001000100010001000100010058025802BB003C00000000000F0000004B000000000005000000040000000000020000000000";
    private static final String WER_TEMPLE_DREAM_7 = "5555555555005000000000000605000000005050000000000605050000005050500000000605060500005050505000000605050505005050505060000605050505005050505060000605050505005050505000000605050500005050500000000605050000005050000000000605000000005000000000002100000000002102000000002111000000002122010000002121110000002122220100002111111200002122111201002111212112002122122221002111212212002112222212002121222201002122221200002121220100002122120000002121010000002112000000002102000000002100000000005000000000000605000000005050000000000605050000005050500000000605050500005050505000000605050505005050505050000605050505005050505060000605050505005050505000000605050500005050500000000605050000005050000000000605000000005000000000005555555555000800000040008800000040004804000040008848000040004848040040008888480040004844840440008848844440004844488C44008888844848004844888844008884888844004888884840008888880440004888480040838888040040B048480000400088040000400088000000405D080000004000030000000F0000003F000000FF000000FF030000FF0F0000FF3F0000FFFF0000FFFF0300FFFF0F00FFFF0F00FFFF0300FFFF0000FF3F80A9FF0FA0B1FF0310B1FF0000003F0070840F00C0840300C084E1B5BBBBBBBBBBBBBBBBEE00B5BBBBBBBBBBBBBB000000B0BBBBBBBBBBBB00000000B0BBBBBBBBBBA000000000B0BBBBBBBB000000000000B0BBBBBB00000000000000B0BBB40000000009000000B0BB000000000000000000B50000000000000000003500000000000000000025000000000000000000B50000000000000000B0BB00000000000000B0BBBB000000000000B0BBBBBB0000000000B0BBBBBBBB00000000B0BBBBBBBBBB000000B0BBBBBBB6BBBB0000B5BBBBBBBBBBBBBB00B5BBBBBBBBBBBBBBBB10B1BB0BB07B00B5000009000700FFFFFEFF0000FEFF000000007801FFFF030000000000FFFF00000000010006000000520000004F000000000001000000010000000000000000000000000007002D016D00DC880100000000000400CB000100000000000000E1005000000000000F0000005F000000000005000000060000000000020000000000";
    private static final String WER_REALM_WHIRL_6 = "5658618515001450400520001020000914001050000425009554524925005658618515001450400520001020000914001050000425009554524925005658618515001450400520001020000914001050000425009554524925005658618515001450400520001020000914001050000425009554524925000106186099008515555045001555565141006505945940000000000000000106186099008515555045001555565141006505945940000000000000000106186099008515555045001555565141006505945940000000000000000106186099008515555045001555565141006505945940000000000000001450400520001020000914001050000425005554514515005658618515001450400520001020000914001050000425005554514515005658618515001450400520001020000914001050000425005554514515005658618515001450400520001020000914001050000425005554514515005658618515004001055456006145155451004595555450005902692690000000000000004001055456006145155451004595555450005902692690000000000000004001055456006145155451004595555450005D02692690000000000000834001055456B061451554510045955554500059016926905D0000000000000FBC07000FBC07000FBC07000FBC0700000000000FBC07000FBC07000FBC07000FBC070000000000EF3D0000EF3D0000EF3D0000EF3D80A90000A0B1EF8117B1EF810700EF817784EF81C7840000C08400000C00C000000C00C00000007A0000000000000000000000000000000000000C00C000000C00C000C004004C00C004004C00000C00C000000C00C6000000090000000000000000000B00000000000000060C00C000600C00C000C004004C00C004004C00000C00C000000C00C7000000000000000000000000000600000000000080050C00C000E00C00C000C004004C00C004004C00000C00C000000C00C0000002000000000000000000010000000000000000000300C000700C00C000C004004C00C004004C1066B4BBB51BB50B0000060007000700FFFFFEFFFEFFFFFF0000FFFFFFFF080001000000D70000000000000009000E00030079017A010000010050005100130002000000D60000000000000010001200040058025802CC000100010001000A000100E1000A0000006400000000000F00000073000000000005000000080000000000020000000000";
    private static final String WER_LAND_CREAT_5 = "5555555555000000000000000000000500000000140000000000000500000005140000000000000500000005140000001400000500000005000000000000000500002445015000000000000514005405055000000000000500000000000005000505050500000000000005009050500000000000000005000100000100000100440100000100441000000100001000000100000100000110400100004510401000004500001000000100000100000150040100000150041000000100001001000100000145000100010144000100111000000100001001001111110101001111110110000100000010000100000000000000000000000000000500000000140000000000000500000005140000000000000500000005140000001400000500000005000000000000000500002445015000000000000514005405045000000000000500000000000005000505050500000000000005009050500000000000000005005555555555000000400040000000510040000000110440000000000440000000400040000004500040001104100440001100000440000000400040000014410040000014010440000000004440000000404051000000440051000040040440830000004440B044444440400044444400440000000000445D000000004000300B0000C2C3090014340000082A08001A0000002A020A000C1C08000A020000235C0400A8920600086602000431080002010000C10082A98308A1B136AC14B192400F00402270844000CE844402C484410353030363B30393F334303030C0333330303003D30303330333036303303030373F30373030300303030303033303030330304330303333802030330333836303D30303839033303E303033303D300C03030303033303030330303330E33053303E34030333330B033303030330F03030303033333F30333303090303333333F330303D303AB03330303303030303F3033363F3033030303030303337333030333383333303033303333333333C33303933383EA33F30036303033303033303033030303530301051BBBBBBB6BBBB000007000500FFFF0000FEFFFEFFFEFFFEFFFEFF0000FEFFFEFFFEFFFEFFFEFF000004000200000000007B017C017D017E017F010000800181018201830184010000110000000000F08858025802580258025802E688580258025802580258027800000000000F000000870000000000050000000A0000000000020000000000";
    private static final String WER_MAZE_WANDER_4 = "5555555511000005000105005005410014005015414004005055410404000051101414000004500401000004441051004040001005004400040010004000000004001050150000000050151400000040451000001050140451000011111440001041000000000005140054004050510510005015041010001000000040001001004154001004044441005441404454000454010050004000450014001050510111000010515400004055051140004015100400000001044454001050554145000004054101000040154005001150505045000000100400000055005000001040004004000050450445000000010001000000151104000001014014005415410004005055444105001450001414000104551001005404401111004440541405004000001510004410041005000155150400005055151454005540050400004051140541001110101440000001500400000001001444000410114010004410100514000000000000001010100001001010544405000011050510005411144515000054441014004400001015005115545040000400001540005150011150005010040050000101004444000154150050000040015044000051054045001014545055830100410004B055410110040011001000000001150004105D00000010000005010800112A020044490100043303000A180000818008006008080041C400001B56000049A0010020110000E007050022010200980288A94945AAB15F0011B191880200424870844D00C284AA02C88400010000000800000000000300500000090040000000080009000090000A00340908008000304000000000990000000000080000000000000007000000A0600A0039000008000000000080CA000400000040A09000009003000AA040000080000000000000000800000B00008000A000F044440400000A00050000F0F49000A00000000000404F000000080000030A04D004800909400000F00000F0000000000009049000000000050000000000000000000000A0A008040000303000090F00000000000020000010B1B9BB44B4B44000000600020000000000FFFF00000000FFFFFFFFFFFFFFFFFFFF0D000000FFFF000011000B000000000000009300BF0003000100010000000200D20000000000000005000F000E890000CE0003003801010001000000C80001003A01000002008C00000000000F0000009B0000000000050000000C0000000000020000000000";
    private static final String WER_COSMIC_3 = "5555555555005492D2001500946500000000541A600D0000555501001500545500D60000501500000000400550610D0040050000000000150000D5000054500100001050155460004054554455001441050100005545410045002850150011000050150044002805400010001540551445004010511515000140060000004196150141004166140141000119041141000100041100000500051001001540051001001550150411005540150411005501150410005505040010001515401401004514544545000101454111000155014011008910404011008905514011000151444105005555100400000104044001005492D2001500946500000000541A600D0000555501001500545500D60000501500000000400550610D0040050000000000150000D5000054500100001050155460004054550455001441050100005545410045002850150011000050154044002805400010001540551445004010511515005555555555000090010040009065454050009019454050004006414450000000410440000140014440000550014440000554054144001550054144005540050144005501010044004505104540001105555151004040515044004055005044832204104044B062411450440040145150410055150400445D00010150400000010000880D0700D00D0700E03107000030000000C0000000C00000001C0300001C0300001C0C0000000C00C0270000000A0000000980A98000A0B1C60710B106000000000870840000C0840000C0840000000000000000000000031000000000000302000000F000000000000000A0000000000000090A06000000000000000000000000000000000F0000000000000000000050000000A000000A0A0000000000000000000000A00000000000000A030000000003000000000000000000000044440440000000000000004020009000A00000000004000000000000000C4900002000011020020044440408000000200100000000F0000000000B0F700040000001C09101000000011070100600000000020000001111106359BB6BB60BB0000000000000000000000000FFFFFFFFFFFF02000400FFFFFFFF00000000FFFF000000000000000000000100600062006300050011005B0000000000000000000000A4897289408900000100010001000100030002000100C80000000000CF00A000000000001E000000BE00000000000A0000000E0000000000020000000000";
    private static final String WER_COSMIC_2 = "5555555555001004545515004110005001000441000004001004010000004010040055000041100014000004410055000010040000000040500000000000115005000000044015000010104055000040455555000040051111005515151111001111111111001111111111001111111111001111111111001104040000004110001050000541000054001104010054004110040014000141100001000104410001000110040110000140100150000100410050000100151040000100015000000150511000000110400000000150519999000100000000009999999999000100000000009999999999000100000000001004545515004110005001000441000004001004010000004010040055000041100014000004410055000010040000000040500000000000115005000000044015000010104055000040455555000040051111005515151111001111111111001111111111001111111111001111111111005555555555000401010040001004000454004110000055000441000055001004010045004010044040000041104040000004410044000010440054000040100054000040050450000040001440000054140440000004100040000054546666830000000040B066666666660000000000400066666666665D00000000400050000000CC0004004094000020A0000010100500348D0000C0360200800200000081040010900000881A0B00AC12050064040000D80780A96154A5B1000010B155550500000070845555C5840000C0840007CDCC0B0000000000000000CCBBBBCB0000077D0007C0ABAABACC7C00EE000000BCAABAC54C00EE7E0000B0AAAABA4B00EEEE07F070BBBBAA0700EEE67E7000C0DCAB0200EE68EE00F070CCABAA008EF9E67ED010CCCCAC008E6666EE07A7ABAAAA00EE6F66EE13ACAB000000EE66E6EECCACAC200000EE66EEE4CCA4AA000000EEEEEE44440400000000EEEEEEF402040008000D00000000000000000000080F0D0008000000000F000000000000000000000801000F000800000000000000000000000000001013B9646622B234000000000000040000000B0000000300040002000000010002000000FFFF030000000000000000000000D000000002000E000E00010001000100000003000B000000088AD689FE8900003A01CC89030013001200010001000100F48904000300C8000000000014000000DC000000000014000000100000000000020000000000";
    private static final String WER_COSMIC_1 = "5555555555004040000405001400011015000400045114000400141100001100451100004440411144001055411115004404111014001011005555000044001114004050554441001141051114000000404445000055550510000444455455000400411428000000011500001000101400001040101428000141440440005100115541001100440400000500101145001100044455004500011155001141104441004114001141005551104501000114440445000110004410005111404411000150504410000155500411000140105504000514405401000100041589000100004489001140111089000100004401004040000405001400011015000400045114000400141100001100451100004440411144001055411115004404111014001011005555000044001114004050554441001141051114000000404445000055550510000444455455000400411428000000011500001000101400001040101428005555555555004010110150001440445550000400110140000100444451000400015155001140404455004410045150001005404450005514445140000005114151000004001144005404105144000014141144004015144144000010441641830105105240B000004146620000000051620004500444625D000000514000308102004203000082100E00D700000005210100C6250E00100C080000400000637A01002678080004400000D547080040160800400483A9AC43A2B1002811B15C020100090070842546C184F1D0C1840000EF0F00000200000000F1FEFE0000000D000009DFEFEF0F007000000020FEFEFEAE700200000000EFEFEF0F00000000000EF0FEFE02D000000000EE00EF0F000002020000EE0E5000200800000002EEE21000D00000000000EEEE0E00100000005005EEEEEE00000000000000EEEEEE55550500200000EEEEEE15FF0500070000EEE6EEF5FF2500000000EEEEEE5E55EE30000000EEEEEEEEEE0E4CCB2370EEDEE9EEEEEE100D0200EEEEEEEEEEEE5E050000EEEEEEEEEEEEEEC00000EEEEEDEEEEEE5E15080010139BBBBB66BB450000030000000100FFFF00006900FFFFFFFFFFFF03000400FFFF0000FFFFFFFF000000000000000072000000D400600062005B0004000F005F0000000000030000006C8A3A8A628A010000003A01010001000100010013000100588A000004002C0100000000230000004F01000000000F000000120000000000020000000000";
    private static final String WER_CASTLE_1 = "5555555555005401004015000054555500000000544500005401004015000000140000008055140000004095540500000000548501008055004000004095144001000000140000008055540500004055580500000000540400000000400400005401544415000000580500000054551500005401004015000100000000000504004040000504008041000504045040001100041010005100411010005100051010005100010010005100055014004100055014005100011010005100051010005100150010005100051210001100401A10001100401A10000504045240000504004040000504004040000100000000005401004015000054555500000000544500005401004015000000140000008055140000004095540500000000548501008055004000004095144001000000140000008055540500004095580500000000540400000000400400005401544415000000580500000054551500005401004015005555555555000000000040000101001050000101006050000101011450000400010444001440100444001440010444001440000044001440011445001040011445001440100444001440010444001440050044001440810444000400900644830400900644B001018114500001010010500001010010505D000000004000F08902004007000080B00800A14108007F4102008C430D00F9000700A2710900F1810700AFC007008142020020800A00FF5B0F00C24F8BA9102AAEB1346C11B1210F0800A01A78842130C8840301C58402000000000000000000F3FF0F00000000F0FF0FF0FF0F0000000010FF0FF0FF0F00F0FFFFF0FF0F00000000F0FFFF0000000000000000F0FF00090000200000F0FFFF00000000000000000000D0000000000000F0FFFF000000C0207080F0FFFF1005000000000000F0FF00000000000000F0FFFF0000000020050040000000000000000000500000000A000000000000100000000000000000000000000000F0FF0F00B06200F0FF0FF0FF0F00000000F0FF0FF0FF0F00000000F0FF0F00000000000000000000101BB8BBBBBBBB90000000000000020000000000FEFFFEFFFEFF0300010010009F0097FF000000000000000000000000010000009C0186018C011C39980067009E008000000000000000D08A9E8AC68A000014885802580258021000030005000A000D00000000000000000000000100000000000000000001000000000000000000010000000000";
    private static final String WER_CASTLE_2 = "0000000000F80000000000FE5000000005CC5000540505BE00000000000300001400000C0000140000A20000540500010000584501A10000004000A30000544601DE0000140000070000580500D80000040000DE0000400400C600004004001E0000400400015000000005CC5000000005DC0000000000C80000000000DC0000000000F81001000011F90000041000060000041000B90000401000B60000041000EC0000140000D800000450040D00000450046400004012008D0000041100000000000000030000000000000000401A00CB0000401A000F0000000000DA1001000011010000000000A40000000000BA0000000000A25000000005C35000540505B20000000000000000140000B20000140000000000540500A20000584501010000004000DC0000544601A80000140000F80000580500DE0000000000A20000400400DE0000400400BB0000400400DC5000000005105000000005CD0000000000A10000000000BE0000000000020000000000A64400004004A20000010400010000010400000000100400000000010400000000050000010000011401000000011401A60000900400CD0000410400000000000000010000000000200000900600000000900600DA0000000000004400004004BE0000000000060000000000C6000000AA1280045B00000000128014CC000000C50000D00000009001000200C600BEC12100BEC100003820AA003ED0DB000210DA003EC0040038C0A10038D0BE12BEA4F2000000C61280042E0000505440444444444444444404A4000A00000000A0004A04FF404444444404FF40A4C04A00F4FFFF740C4A04440400F4FFFF4444400404000040F4FF04404004040000F4FFFF044040040400002444444044400404000084000074404004040000040000C449400404000040040044444B0404000054000004404004040000144444004040040400003400000440400404000040646704404004440400406460444440A4C04A00040000A40C4A04FF404444444404FF40A4000A00B00000A0004A404444444444444444048028B21BBBBB01900000000000002700000012000000010000000000FEFFFEFFFFFF0000000000000000010000000100FFFF7D00000000008C008F00D801D901000000000000000000000000FFFF010027000C00E2877E87360143015802580274870000000000000000000000000100000000000000000001000000000000000000010000000000";
    private static final String WER_CASTLE_3 = "0000000000F80000000000FE0000000000CC0000540500BE00000000000300009406000C0000140000A20000580500010000004001A10000004006A30000000001DE0000000000070000000000D80000000000DE0000000000C600000000001E0000000000010000000000CC0000000000DC0000000000C80000000000DC0000000000F80000000000F90000041000060000041000B90000401100B60000041100EC0000000000D800000040040D00000000086400000000008D0000000000000000000000030000000000000000000000CB00000000000F0000000000DA0000000000010000000000A40000000000BA0000000000A20000000000C30000540500B20000000000000000940600B20000140000000000580500A20000004001010000004002DC0000000005A80000000000F80000000000DE0000000000A20000000000DE0000000000BB0000000000DC0000000000100000000000CD0000000000A10000000000BE0000000000020000000000A60000000000A20000010400010000010400000000500400000000410400000000000000010000001001000000000007A60000000000CD0000000000000000000000010000000000200000000000000000000000DA0000000000000000000000BE0000000000060000000000C6000000AA0000005B00000000003E10CC003E00C50038D000003E9001000200C600BEC12100BEC100003820AA003ED0DB000010DA0000C0040000C0A10000D0BE0000A0F2000000C60000002E000050540000000000000000000000880000000000008800802B080000000080B20800880000000000008800000000000000040000000000000000300000000000000000600050000000000000001999990000000000000079000029000000000000090000C9ED000000000090090099000000000000F900000900000000000080999900000000000000000000000000000000000000000000000000000000000000000000880000000000008800802B080000000080A208008800000000000088000000000000000000000080B1BB2B22BB5BBB000000000000FEFFE07400001500270000000000FEFFFEFF00000000C6000000000000000000E701C80000007E000100FFFFFEFFE601E001B9000100C500CC000000FFFF1A8758020C009A020C00010027004F0058025802370101000A0039010000000000000100000000000000000001000000000000000000010000000000";
    private static final String WER_LVL_11 = "0000000000F80050515101FE0005040404CC40A496A201BE10010000000344001404500C1004411014A20010000400010000280000A10509411490A35010000005DE5010000005070909811490D80000280000DE0010000400C610044110141E4400140450011001000000CC40A496A501DC0005040404C80000000000DC0010142804F80021281418F94054455515061051455515B94450114505B61444555541EC1454554541D814544545410D11510145116421620145218D1151014511001454454541031454554541001444555541CB44501145050F1051455515DA4054455515010021281818A40010142804BA0050515501A20005040404C340A495A201B21001000000004400140450B21004411014000010000400A20000280000010909811490DC5010000005A85010000005F80505411490DE0000180000A20010000400DE1004411014BB4400140450DC10010000001040A496A601CD0005040404A10050515501BE0000000000020004050501A64004050505A21055515505014454515505001154445141000551555550000555555150010555515150004454405144A68854405144CD4454405144000555515150010555555150200551555550001154445141DA4454515505001055515505BE4004050606060004050501C6FFFF0FAA3F020E5B0F200C0027261DCC33260DC53900D1001D4197015D6107C65D61C7214C00C300000020AA4C00D3DB5D6117DA5D61C7041D41C7A13900D1BE3326ADF227260DC60F000C2E3F025E5400000000000000000000000000000000E00000000000000F00F000F0000000000010000003860000000000000000000E0000000000000000E00E00000000000000E0E00000000000000000E0040000000000000000E000000000000000000000000000000F000F000200D00BC00A000000000000050000F000000000F0E0000000000000000000E0000000000000000000E0E0000000000000000000E00E0000000000000000000E000000000010000000070000000000F000009FF000000000000000000000000040444444B4BB44B50000070007000C000C000C000C000C000F000E0000000F000F000C000000A10000000A000A0006000A000E0006000E000A00B400B600B8000A000A000000A0000000060005000600060006000500050006002E012F0130010500050000000A000000000000000100000000000000000001000000000000000000010000000000";
    private static final String WER_LVL_15 = "5555555511000005000105005005410014005015414004005055410404000051101414000004500401000004441051004040001005004400040010004000000004001050150000000050151400000040451000001050140451000011111440001041000000000005140054004050510510005015041010001000000040001001004154001004044441005441404454000454010050004000450014001050510111000010515400004055051140004015100400000001044454001050554145000004054101000040154005001150505045000000100400000055005000001040004004000050450445000000010001000000151104000001014014005415410004005055444105001450001414000104551001005404401111004440541405004000001510004410041005000155150400005055151454005540050400004051140541001110101440000001500400000001001444000410114010004410100514000000000000001010100001001010544405000011050510005411144515000054440014004400001015005115545000000400001500005150011110005010040010000101004404000154150010000040015004000051054005001014545055830100410004B055410110040011001000000001150004105D00000010000005010800112A020044490100043303000A180000818008006008080041C400001B56000049A0010020110000E007050022010200980288A94945AAB15F0011B191880200424870844D00C284AA02C88400010000000800000000000300500000090040000000080009000090000A00340908008000304000000000990000000000080000000000000007000000A0600A00390000080000000000809A000400000040A09000009003000AA040000080000000000000000800000000008000A000F044440400000A00050000F0F49000A00000000000404F000000080000030A04D004800909400000F00000F0000000000009049000000000050000000000000000000000A0A008040000303000090F00000000000020000010B1B9BB44B4BB4000000600020000000000FFFF00000000FFFFFFFFFFFF000000000D000000FFFF000011000B000000000000009300BF0003000100010000006400D20000000000000005000F000E890000CE0003003801010001000000E10013013A01000002008C00000000000F0000009B0000000000050000000C000000000002000000";

    private static final String[] PMO_LEVEL_DATA = new String[]{L1, L2, L3, L4, L5, L6, L7, L8, L9, L10};
    public static final MazeLevel[] PMO_LEVELS = new MazeLevel[PMO_LEVEL_DATA.length];

    private static final String[] KOD_LEVEL_DATA = new String[]{W2L1, W2L2, W2L3, W2L4, W2L5, W2L6};
    public static final MazeLevel[] KOD_LEVELS = new MazeLevel[KOD_LEVEL_DATA.length];

    private static final String[] LEG_LEVEL_DATA = new String[]{W3L1, W3L2, W3L3, W3L4, W3L5, W3L6};
    public static final MazeLevel[] LEG_LEVELS = new MazeLevel[LEG_LEVEL_DATA.length];

    private static final String[] BS_LEVEL_DATA = new String[]{BSL1, BSL2, BSL3, BSL4, BSL5, BSL6, BSL7, BSL8};
    public static final MazeLevel[] BS_LEVELS = new MazeLevel[BS_LEVEL_DATA.length];

    public static final String[] WER_LEVEL_DESC = new String[]{"Castle 1", "Cosmic Cube 1", "Cosmic Cube 2", "Cosmic Cube 3",
        "Maze of Wandering", "Land of the Creatures of Light and Darkness", "Realm of the Whirling Dervish",
        "Temple of the Dreampainter ", "Land of a Thousand Cuts", "The Catacombs", "Pyramid of Entrapment",
        "Grandmaster Ending - Castle and Level 11", "Castle 2", "Castle 3", "Unknown Level 15"};
    private static final String[] WER_LEVEL_DATA = new String[]{WER_CASTLE_1, WER_COSMIC_1, WER_COSMIC_2, WER_COSMIC_3, WER_MAZE_WANDER_4,
        WER_LAND_CREAT_5, WER_REALM_WHIRL_6, WER_TEMPLE_DREAM_7, WER_LAND_CUTS_8, WER_CATACOMBS_9,
        WER_PYRAMID_ENTRAP_10, WER_LVL_11, WER_CASTLE_2, WER_CASTLE_3, WER_LVL_15};
    public static final MazeLevel[] WER_LEVELS = new MazeLevel[WER_LEVEL_DATA.length];

    public static List<Item> PMO_ITEMS, KOD_ITEMS, LEG_ITEMS, BS_ITEMS, WER_ITEMS;
    public static final java.util.Map<String, Item> PMO_ITEMS_MAP = new HashMap<>();
    public static final java.util.Map<String, Item> KOD_ITEMS_MAP = new HashMap<>();
    public static final java.util.Map<String, Item> LEG_ITEMS_MAP = new HashMap<>();
    public static final java.util.Map<String, Item> BS_ITEMS_MAP = new HashMap<>();
    public static final java.util.Map<String, Item> WER_ITEMS_MAP = new HashMap<>();

    public static List<Monster> PMO_MONSTERS, KOD_MONSTERS, LEG_MONSTERS, BS_MONSTERS, WER_MONSTERS;
    public static final java.util.Map<String, Monster> PMO_MONSTER_MAP = new HashMap<>();
    public static final java.util.Map<String, Monster> KOD_MONSTER_MAP = new HashMap<>();
    public static final java.util.Map<String, Monster> LEG_MONSTER_MAP = new HashMap<>();
    public static final java.util.Map<String, Monster> BS_MONSTER_MAP = new HashMap<>();
    public static final java.util.Map<String, Monster> WER_MONSTER_MAP = new HashMap<>();

    public static List<DoGooder> WER4_CHARS;
    public static final java.util.Map<String, DoGooder> WER4_CHAR_MAP = new HashMap<>();

    public static List<Reward> PMO_REWARDS, KOD_REWARDS, LEG_REWARDS, BS_REWARDS;
    public static List<Message> PMO_MESSAGES, KOD_MESSAGES, LEG_MESSAGES, BS_MESSAGES, WER_MESSAGES;

    static {
        try {
            String j1 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/pmo-items.json"));
            String j2 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/pmo-monsters.json"));
            String j3 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/pmo-rewards.json"));
            String j4 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/pmo-messages.json"));

            String j5 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/kod-items.json"));
            String j6 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/kod-monsters.json"));
            String j7 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/kod-rewards.json"));
            String j8 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/kod-messages.json"));

            String j9 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/leg-items.json"));
            String j10 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/leg-monsters.json"));
            String j11 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/leg-rewards.json"));
            String j12 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/leg-messages.json"));

            String j13 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/bs-items.json"));
            String j14 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/bs-monsters.json"));
            String j15 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/bs-rewards.json"));
            String j16 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/bs-messages.json"));

            String j17 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/wer-items.json"));
            String j18 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/wer-messages.json"));
            String j19 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/wer-characters.json"));
            String j20 = IOUtils.toString(WizardryData.class.getResourceAsStream("/assets/json/wer-monsters.json"));

            GsonBuilder builder = new GsonBuilder();
            Gson gson = builder.create();

            PMO_ITEMS = gson.fromJson(j1, new TypeToken<List<Item>>() {
            }.getType());
            KOD_ITEMS = gson.fromJson(j5, new TypeToken<List<Item>>() {
            }.getType());
            LEG_ITEMS = gson.fromJson(j9, new TypeToken<List<Item>>() {
            }.getType());
            BS_ITEMS = gson.fromJson(j13, new TypeToken<List<Item>>() {
            }.getType());
            WER_ITEMS = gson.fromJson(j17, new TypeToken<List<Item>>() {
            }.getType());

            PMO_MONSTERS = gson.fromJson(j2, new TypeToken<List<Monster>>() {
            }.getType());
            KOD_MONSTERS = gson.fromJson(j6, new TypeToken<List<Monster>>() {
            }.getType());
            LEG_MONSTERS = gson.fromJson(j10, new TypeToken<List<Monster>>() {
            }.getType());
            BS_MONSTERS = gson.fromJson(j14, new TypeToken<List<Monster>>() {
            }.getType());
            WER_MONSTERS = gson.fromJson(j20, new TypeToken<List<Monster>>() {
            }.getType());

            PMO_REWARDS = gson.fromJson(j3, new TypeToken<List<Reward>>() {
            }.getType());
            KOD_REWARDS = gson.fromJson(j7, new TypeToken<List<Reward>>() {
            }.getType());
            LEG_REWARDS = gson.fromJson(j11, new TypeToken<List<Reward>>() {
            }.getType());
            BS_REWARDS = gson.fromJson(j15, new TypeToken<List<Reward>>() {
            }.getType());

            PMO_MESSAGES = gson.fromJson(j4, new TypeToken<List<Message>>() {
            }.getType());
            KOD_MESSAGES = gson.fromJson(j8, new TypeToken<List<Message>>() {
            }.getType());
            LEG_MESSAGES = gson.fromJson(j12, new TypeToken<List<Message>>() {
            }.getType());
            BS_MESSAGES = gson.fromJson(j16, new TypeToken<List<Message>>() {
            }.getType());
            WER_MESSAGES = gson.fromJson(j18, new TypeToken<List<Message>>() {
            }.getType());

            WER4_CHARS = gson.fromJson(j19, new TypeToken<List<DoGooder>>() {
            }.getType());

            for (Item i : PMO_ITEMS) {
                PMO_ITEMS_MAP.put(i.name, i);
            }

            for (Item i : KOD_ITEMS) {
                KOD_ITEMS_MAP.put(i.name, i);
            }

            for (Item i : LEG_ITEMS) {
                LEG_ITEMS_MAP.put(i.name, i);
            }

            for (Item i : BS_ITEMS) {
                BS_ITEMS_MAP.put(i.name, i);
            }

            for (Item i : WER_ITEMS) {
                WER_ITEMS_MAP.put(i.name, i);
            }

            for (DoGooder i : WER4_CHARS) {
                WER4_CHAR_MAP.put(i.name, i);
            }

            for (Monster m : PMO_MONSTERS) {
                PMO_MONSTER_MAP.put(m.name, m);
            }

            for (Monster m : KOD_MONSTERS) {
                KOD_MONSTER_MAP.put(m.name, m);
            }

            for (Monster m : LEG_MONSTERS) {
                LEG_MONSTER_MAP.put(m.name, m);
            }

            for (Monster m : BS_MONSTERS) {
                BS_MONSTER_MAP.put(m.name, m);
            }
            for (Monster m : WER_MONSTERS) {
                WER_MONSTER_MAP.put(m.name, m);
            }

            for (int i = 0; i < PMO_LEVEL_DATA.length; i++) {
                PMO_LEVELS[i] = new MazeLevelV1(1, DatatypeConverter.parseHexBinary(PMO_LEVEL_DATA[i]), i + 1, PMO_MONSTERS, PMO_MESSAGES);
            }

            for (int i = 0; i < KOD_LEVEL_DATA.length; i++) {
                KOD_LEVELS[i] = new MazeLevelV1(2, DatatypeConverter.parseHexBinary(KOD_LEVEL_DATA[i]), i + 1, KOD_MONSTERS, KOD_MESSAGES);
            }

            for (int i = 0; i < LEG_LEVEL_DATA.length; i++) {
                LEG_LEVELS[i] = new MazeLevelV1(3, DatatypeConverter.parseHexBinary(LEG_LEVEL_DATA[i]), i + 1, LEG_MONSTERS, LEG_MESSAGES);
            }

            for (int i = 0; i < BS_LEVEL_DATA.length; i++) {
                BS_LEVELS[i] = new MazeLevelV1(4, DatatypeConverter.parseHexBinary(BS_LEVEL_DATA[i]), i + 1, BS_MONSTERS, BS_MESSAGES);
            }

            for (int i = 0; i < WER_LEVEL_DATA.length; i++) {
                WER_LEVELS[i] = new MazeLevelV4(5, DatatypeConverter.parseHexBinary(WER_LEVEL_DATA[i]), i + 1, WER4_CHARS, WER_MESSAGES);
            }
        } catch (Throwable t) {
            t.printStackTrace();
        }

    }

    public static enum Scenario {
        PMO(PMO_ITEMS, PMO_MONSTERS, PMO_REWARDS, PMO_MESSAGES, PMO_LEVELS, PMO_MONSTER_MAP, PMO_ITEMS_MAP),
        KOD(KOD_ITEMS, KOD_MONSTERS, KOD_REWARDS, KOD_MESSAGES, KOD_LEVELS, KOD_MONSTER_MAP, KOD_ITEMS_MAP),
        LEG(LEG_ITEMS, LEG_MONSTERS, LEG_REWARDS, LEG_MESSAGES, LEG_LEVELS, LEG_MONSTER_MAP, LEG_ITEMS_MAP),
        BS(BS_ITEMS, BS_MONSTERS, BS_REWARDS, BS_MESSAGES, BS_LEVELS, BS_MONSTER_MAP, BS_ITEMS_MAP),
        WER(WER_ITEMS, WER_MONSTERS, null, WER_MESSAGES, WER_LEVELS, WER_MONSTER_MAP, WER_ITEMS_MAP, 11, 9, 9);

        private final List<Item> items;
        private final List<Monster> monsters;
        private final List<Reward> rewards;
        private final List<Message> messages;
        private final MazeLevel[] levels;
        private final java.util.Map<String, Monster> monsterMap;
        private final java.util.Map<String, Item> itemMap;
        private final int startLevel, startX, startY;

        private final java.util.Map<String, DoGooder> characterMap;
        private final List<DoGooder> characters;

        private Scenario(List<Item> items, List<Monster> monsters, List<Reward> rewards, List<Message> messages,
                MazeLevel[] levels, Map<String, Monster> monsterMap, Map<String, Item> itemMap) {
            this.items = items;
            this.monsters = monsters;
            this.rewards = rewards;
            this.messages = messages;
            this.levels = levels;
            this.monsterMap = monsterMap;
            this.itemMap = itemMap;
            this.startLevel = 1;
            this.startX = 0;
            this.startY = 0;
            this.characterMap = null;
            this.characters = null;
            for (Item i : items) {
                i.scenarioID = this.ordinal();
            }
        }

        private Scenario(List<Item> items, List<Monster> monsters, List<Reward> rewards, List<Message> messages,
                MazeLevel[] levels, Map<String, Monster> monsterMap, Map<String, Item> itemMap, int startLevel, int startX, int startY) {
            this.items = items;
            this.monsters = monsters;
            this.rewards = rewards;
            this.messages = messages;
            this.levels = levels;
            this.monsterMap = monsterMap;
            this.itemMap = itemMap;
            this.startLevel = startLevel;
            this.startX = startX;
            this.startY = startY;
            this.characterMap = WER4_CHAR_MAP;
            this.characters = WER4_CHARS;
            for (Item i : items) {
                i.scenarioID = this.ordinal();
            }
        }

        public int getStartLevel() {
            return startLevel;
        }

        public int getStartX() {
            return startX;
        }

        public int getStartY() {
            return startY;
        }

        public List<Item> items() {
            return items;
        }

        public List<Monster> monsters() {
            return monsters;
        }

        public List<DoGooder> characters() {
            return characters;
        }

        public List<Reward> rewards() {
            return rewards;
        }

        public List<Message> messages() {
            return messages;
        }

        public MazeLevel[] levels() {
            return levels;
        }

        public Map<String, Monster> monsterMap() {
            return monsterMap;
        }

        public Map<String, DoGooder> characterMap() {
            return characterMap;
        }

        public Map<String, Item> itemMap() {
            return itemMap;
        }

        public static Item getItem(int id, String name) {
            for (Scenario sc : Scenario.values()) {
                for (Item it : sc.items) {
                    if (it.id == id && it.name.equals(name)) {
                        return it;
                    }
                }
            }
            return null;
        }

    }

    public static abstract class MazeLevel {

        public int level;
        public int scenario;
        public MazeCell[][] cells = new MazeCell[DUNGEON_DIM][DUNGEON_DIM];
        public final List<Integer> defeated = new ArrayList<>();

        public abstract int getRandomMonster();

        public boolean rotate(MazeCell cell) {

            if (!cell.spinner || cell.rotateDirection == -1) {
                return false;
            }

            boolean northWall = cell.northWall;
            boolean southWall = cell.southWall;
            boolean eastWall = cell.eastWall;
            boolean westWall = cell.westWall;

            boolean northDoor = cell.northDoor;
            boolean southDoor = cell.southDoor;
            boolean eastDoor = cell.eastDoor;
            boolean westDoor = cell.westDoor;

            boolean clockwise = cell.rotateDirection == 1;

            if (clockwise) {
                cell.northWall = eastWall;
                cell.eastWall = southWall;
                cell.southWall = westWall;
                cell.westWall = northWall;
                cell.northDoor = eastDoor;
                cell.eastDoor = southDoor;
                cell.southDoor = westDoor;
                cell.westDoor = northDoor;
            } else {
                cell.northWall = westWall;
                cell.westWall = southWall;
                cell.southWall = eastWall;
                cell.eastWall = northWall;
                cell.northDoor = westDoor;
                cell.westDoor = southDoor;
                cell.southDoor = eastDoor;
                cell.eastDoor = northDoor;
            }

            if (cell.eastWall && cell.eastDoor) {
                cell.hiddenEastDoor = true;
            } else {
                cell.hiddenEastDoor = false;
            }
            if (cell.westWall && cell.westDoor) {
                cell.hiddenWestDoor = true;
            } else {
                cell.hiddenWestDoor = false;
            }
            if (cell.northWall && cell.northDoor) {
                cell.hiddenNorthDoor = true;
            } else {
                cell.hiddenNorthDoor = false;
            }
            if (cell.southWall && cell.southDoor) {
                cell.hiddenSouthDoor = true;
            } else {
                cell.hiddenSouthDoor = false;
            }

            return true;
        }

    }

    private static class MazeLevelV1 extends MazeLevel {

        private byte[] buffer;
        private CellInfo[] cellInfo;
        private byte[][] cellInfoLocations;
        private EncounterOdds[] monsterOdds = new EncounterOdds[3];

        public MazeLevelV1(int scenario, byte[] buffer, int level, List<Monster> monsters, List<Message> messages) {
            this.level = level;
            this.buffer = buffer;
            this.scenario = scenario;

            this.cellInfoLocations = getCellInfoLocations(buffer, 0 + 0x230);
            this.cellInfo = getCellInfo(buffer, 0 + 0x2F8);
            this.monsterOdds = getMonsterOdds(buffer, 0 + 0x360);

            for (int x = 0; x < DUNGEON_DIM; x++) {
                for (int y = 0; y < DUNGEON_DIM; y++) {

                    cells[x][y] = walls(x, y);

                    if (cells[x][y].lair) {
                        int mid = getRandomMonster();
                        Monster m = mid < monsters.size() ? monsters.get(mid) : null;
                        if (m == null) {
                            System.out.println("cannot find monster id " + mid);
                        } else {
                            cells[x][y].wanderingEncounterID = m.monsterId;
                        }
                    }

                    MazeCell cell = cells[x][y];

                    int idx = cellInfoLocations[y][x];
                    CellInfo ci = cellInfo[idx];

                    switch (ci.type) {
                        case NORMAL:
                            break;
                        case STAIRS:
                            cell.stairs = true;
                            cell.addressTo = new MazeAddress(ci.val[0], ci.val[1], ci.val[2]);
                            break;
                        case PIT:
                            cell.pit = true;
                            cell.damage = new Dice(ci.val[0], ci.val[1], ci.val[2]);
                            break;
                        case CHUTE:
                            cell.addressTo = new MazeAddress(ci.val[0], ci.val[1], ci.val[2]);
                            cell.chute = true;
                            break;
                        case SPINNER:
                            cell.spinner = true;
                            break;
                        case DARK:
                            cell.darkness = true;
                            break;
                        case TELEPORT:
                            cell.addressTo = new MazeAddress(ci.val[0], ci.val[1], ci.val[2]);
                            cell.teleport = true;
                            break;
                        case DAMAGE:
                            cell.damage = new Dice(ci.val[1], ci.val[2], ci.val[0]);
                            break;
                        case ELEVATOR:
                            cell.elevator = true;
                            cell.elevatorFrom = ci.val[2];
                            cell.elevatorTo = ci.val[1];
                            break;
                        case ROCK:
                            cell.rock = true;
                            break;
                        case NOSPELL:
                            cell.spellsBlocked = true;
                            break;
                        case ENCOUNTER:
                            cell.encounterID = ci.val[2];
                            cell.hasTreasureChest = true;
                            break;
                        case MESSAGE:
                            if (ci.isMessage()) {
                                for (Message m : messages) {
                                    if (m.match(ci.val[1])) {
                                        cell.message = m;
                                        break;
                                    }
                                }
                            }

                            if (ci.val[2] == 2) {
                                cell.itemObtained = ci.val[0];//blue ribbon
                            }
                            if (ci.val[2] == 3) {
                                if (ci.val[0] > 0) {
                                    cell.itemObtained = ci.val[0];//may wade to get
                                }
                            }
                            if (ci.val[2] == 4) {
                                if (ci.val[0] >= 0) {
                                    cell.encounterID = ci.val[0];
                                    cell.hasTreasureChest = true;
                                } else if (ci.val[0] > -1200) {
                                    cell.itemObtained = ci.val[0] * -1 - 1000;
                                } else {
                                    int itemNo = ci.val[0];
                                    itemNo *= -1;
                                    itemNo -= 20000;
                                    cell.tradeItem1 = itemNo / 100;
                                    cell.tradeItem2 = itemNo % 100;
                                }
                            }
                            if (ci.val[2] == 5 || ci.val[2] == 13) {
                                if (ci.val[0] > 0) {
                                    cell.itemRequired = ci.val[0];
                                }
                            }
                            if (ci.val[2] == 14) {//item required or else teleported
                                cell.itemRequired = ci.val[1];
                                cell.addressTo = new MazeAddress(this.level, ci.val[0] / 100, ci.val[0] % 100);
                            }
                            if (ci.val[2] == 8) {//return to castle
                                cell.addressTo = new MazeAddress(1, 0, 0);
                            }
                            if (ci.val[2] == 10) {
                                for (Message m : messages) {
                                    if (m.match(ci.val[0])) {
                                        cell.riddleAnswers = m.text();
                                        break;
                                    }
                                }
                            }
                            if (ci.val[2] == 11) {
                                for (Message m : messages) {
                                    if (m.match(ci.val[0])) {
                                        cell.feeAmount = Integer.parseInt(m.getText());
                                        break;
                                    }
                                }
                            }
                            if (ci.val[2] == 15) {
                                cell.encounterID = ci.val[1];
                                cell.hasTreasureChest = true;
                            }

                            if (ci.val[2] == 16) {
                                cell.encounterID = ci.val[1];
                                cell.hasTreasureChest = true;
                            }
                            break;
                    }
                }
            }

            List<List<MazeCell>> rooms = new ArrayList<>();

            for (int x = 0; x < DUNGEON_DIM; x++) {
                for (int y = 0; y < DUNGEON_DIM; y++) {

                    if (cells[x][y].tempLair) {
                        List<MazeCell> roomCells = new ArrayList<>();
                        getConnectedRoomCells(x, y, roomCells);
                        for (MazeCell c : roomCells) {
                            c.tempLair = false;
                        }
                        rooms.add(roomCells);
                    }

                }
            }

            Collections.sort(rooms, new Comparator<List<MazeCell>>() {
                @Override
                public int compare(List<MazeCell> l1, List<MazeCell> l2) {
                    return Integer.compare(l2.size(), l1.size());
                }
            });

            int pickRoom = 10;
            while (pickRoom > 0 && !rooms.isEmpty()) {
                List<MazeCell> peek = rooms.get(0);
                if (peek.size() == 1) {
                    Collections.shuffle(rooms);
                }
                List<MazeCell> room = rooms.remove(0);
                int pickCell = Utils.RANDOM.nextInt(room.size());
                MazeCell cell = room.remove(pickCell);
                cell.hasTreasureChest = true;
                pickRoom--;
            }
            while (pickRoom > 0) {
                while (true) {
                    int x = Utils.RANDOM.nextInt(DUNGEON_DIM);
                    int y = Utils.RANDOM.nextInt(DUNGEON_DIM);
                    if (cells[x][y].wanderingEncounterID > 0 && !cells[x][y].hasTreasureChest) {
                        cells[x][y].hasTreasureChest = true;
                        break;
                    }
                }
                pickRoom--;
            }
        }

        private MazeCell walls(int row, int column) {
            MazeAddress address = new MazeAddress(level, row, column);
            MazeCell cell = new MazeCell(address);

            // doors and walls
            int offset = column * 6 + row / 4; // 6 bytes/column

            int value = intValue(buffer[offset]);
            value >>>= (row % 4) * 2;
            cell.westWall = ((value & 1) == 1);
            value >>>= 1;
            cell.westDoor = ((value & 1) == 1);

            value = intValue(buffer[offset + 120]);
            value >>>= (row % 4) * 2;
            cell.southWall = ((value & 1) == 1);
            value >>>= 1;
            cell.southDoor = ((value & 1) == 1);

            value = intValue(buffer[offset + 240]);
            value >>>= (row % 4) * 2;
            cell.eastWall = ((value & 1) == 1);
            value >>>= 1;
            cell.eastDoor = ((value & 1) == 1);

            value = intValue(buffer[offset + 360]);
            value >>>= (row % 4) * 2;
            cell.northWall = ((value & 1) == 1);
            value >>>= 1;
            cell.northDoor = ((value & 1) == 1);

            // monster table
            offset = column * 4 + row / 8;
            value = intValue(buffer[offset + 480]);
            value >>>= row % 8;
            cell.lair = ((value & 1) == 1);
            cell.tempLair = cell.lair;

            if (cell.eastWall && cell.eastDoor) {
                cell.hiddenEastDoor = true;
            }
            if (cell.westWall && cell.westDoor) {
                cell.hiddenWestDoor = true;
            }
            if (cell.northWall && cell.northDoor) {
                cell.hiddenNorthDoor = true;
            }
            if (cell.southWall && cell.southDoor) {
                cell.hiddenSouthDoor = true;
            }

            return cell;
        }

        private byte[][] getCellInfoLocations(byte[] buffer, int offset) {
            byte[][] sqrextra = new byte[20][20];
            for (int col = 0; col < 20; col++) {
                for (int row = 0; row < 20; row += 2) {
                    sqrextra[col][row] = (byte) (buffer[offset] & 0x0F);
                    sqrextra[col][row + 1] = (byte) ((buffer[offset] & 0xF0) >>> 4);
                    offset++;
                }
            }
            return sqrextra;
        }

        private CellInfo[] getCellInfo(byte[] buffer, int offset) {
            CellInfo[] info = new CellInfo[16];

            int pos = 0;
            for (int i = 0; i < 8; i++) {
                info[pos] = new CellInfo(pos++, buffer, offset);
                info[pos] = new CellInfo(pos++, buffer, offset);
            }

            return info;
        }

        private EncounterOdds[] getMonsterOdds(byte[] buffer, int offset) {
            EncounterOdds[] enemyCalc = new EncounterOdds[3];

            for (int i = 0; i < 3; i++) {
                enemyCalc[i] = new EncounterOdds(buffer, offset);
                offset += 10;
            }

            return enemyCalc;
        }

        @Override
        public int getRandomMonster() {
            int encounterType = 0;
            while (RANDOM.nextInt(4) == 2 && encounterType < 2) {
                ++encounterType;
            }

            return monsterOdds[encounterType].getRandomMonster();
        }

        private void getConnectedRoomCells(int x, int y, List<MazeCell> roomCells) {
            if (!roomCells.contains(cells[x][y])) {
                roomCells.add(cells[x][y]);
            } else {
                return;
            }
            if (!(cells[x][y].northDoor || cells[x][y].northWall) && x + 1 < cells.length) {
                getConnectedRoomCells(x + 1, y, roomCells);
            }
            if (!(cells[x][y].southDoor || cells[x][y].southWall) && x - 1 >= 0) {
                getConnectedRoomCells(x - 1, y, roomCells);
            }
            if (!(cells[x][y].eastDoor || cells[x][y].eastWall) && y + 1 < cells.length) {
                getConnectedRoomCells(x, y + 1, roomCells);
            }
            if (!(cells[x][y].westDoor || cells[x][y].westWall) && y - 1 >= 0) {
                getConnectedRoomCells(x, y - 1, roomCells);
            }
        }
    }

    private static class MazeLevelV4 extends MazeLevel {

        private byte[] buffer;
        private CellInfo[] cellInfo;
        private byte[][] cellInfoLocations;
        private EncounterOdds[] monsterOdds = new EncounterOdds[3];

        public MazeLevelV4(int scenario, byte[] buffer, int level, List<DoGooder> characters, List<Message> messages) {
            this.level = level;
            this.buffer = buffer;
            this.scenario = scenario;

            this.cellInfoLocations = getCellInfoLocations(buffer, 0 + 0x230);
            this.cellInfo = getCellInfo(buffer, 0 + 0x2F8);
            this.monsterOdds = getMonsterOdds(buffer, 0 + 0x360);

            for (int x = 0; x < DUNGEON_DIM; x++) {
                for (int y = 0; y < DUNGEON_DIM; y++) {

                    cells[x][y] = walls(x, y);

                    MazeCell cell = cells[x][y];

                    int idx = cellInfoLocations[y][x];
                    CellInfo ci = cellInfo[idx];

                    switch (ci.type) {
                        case NORMAL:
                            break;
                        case STAIRS:
                            cell.stairs = true;
                            cell.addressTo = new MazeAddress(ci.val[0], ci.val[1], ci.val[2]);
                            break;
                        case DAMAGE:
                            cell.damage = new Dice(ci.val[1], ci.val[2], ci.val[0]);
                            break;
                        case PIT:
                            cell.pit = true;
                            cell.damage = new Dice(ci.val[0], ci.val[1], ci.val[2]);
                            break;
                        case CHUTE:
                            cell.addressTo = new MazeAddress(ci.val[0], ci.val[1], ci.val[2]);
                            cell.chute = true;
                            break;
                        case SPINNER:
                            if (ci.val[0] == 0 || ci.val[2] == 4) {
                                cell.spinner = true;
                            }
                            if (ci.val[0] == -1 && (ci.val[2] == 0 || ci.val[2] == 1)) {
                                cell.spinner = true;
                                cell.rotateDirection = ci.val[1];
                                if (cell.northWall && cell.eastWall && cell.southWall && cell.westWall) {
                                    cell.northWall = false; //a workaround for cage issue with rotators
                                    cell.northDoor = false;
                                }
                            }
                            break;
                        case DARK:
                            cell.darkness = true;
                            break;
                        case TELEPORT:
                            cell.addressTo = new MazeAddress(ci.val[0], ci.val[1], ci.val[2]);
                            cell.teleport = true;
                            break;
                        case ELEVATOR:
                            cell.elevator = true;
                            cell.addressTo = new MazeAddress(ci.val[1], x, y);
                            cell.elevatorFrom = ci.val[2];
                            cell.elevatorTo = ci.val[1];
                            break;
                        case ROCK:
                            cell.rock = true;
                            break;
                        case NOSPELL:
                            cell.spellsBlocked = true;
                            break;
                        case ENCOUNTER:
                            cell.encounterID = ci.val[2];
                            break;
                        case MESSAGE:

                            if (ci.val[2] == 3) {
                                if (ci.val[0] > 0) {
                                    cell.itemObtained = ci.val[0];//wading to get
                                }
                            }

                            if (ci.val[0] == -2 && ci.val[2] >= 100 && ci.val[2] < 200) {
                                cell.itemObtained = ci.val[2] - 100 + 1;
                            }

                            if (ci.val[2] == 5 || ci.val[2] == 13) {
                                if (ci.val[0] > 0) {
                                    cell.itemRequired = ci.val[0];
                                }
                            }

                            if (ci.val[2] == 10) {
                                for (Message m : messages) {
                                    if (m.match(ci.val[0])) {
                                        cell.riddleAnswers = m.text();
                                        if (ci.val[1] == 214) {
                                            cell.itemObtainedFromRiddle = 56;
                                        }
                                        break;
                                    }
                                }
                            }

                            if (ci.val[2] == 4) {
                                if (ci.val[0] >= 0) {
                                    cell.encounterID = ci.val[0];
                                }
                            }

                            if (ci.val[0] > 0) {
                                cell.encounterID = ci.val[0];
                            }

                            if (ci.val[2] == 600) {
                                cell.encounterID = ci.val[1];
                            }

                            if (ci.val[2] == 200 || (ci.val[2] == -30220 && ((x == 4 && y == 0) || (x == 18 && y == 14))) || (ci.val[2] == -30120 && x == 14 && y == 1)) {
                                cell.summoningCircle = SummoningCircle.CIRCLE1;
                            }
                            if (ci.val[2] == 201 || (ci.val[2] == -30120 && x == 11 && y == 5)) {
                                cell.summoningCircle = SummoningCircle.CIRCLE2;
                            }
                            if (ci.val[2] == 202 || (ci.val[2] == -30120 && x == 3 && y == 2)) {
                                cell.summoningCircle = SummoningCircle.CIRCLE3;
                            }
                            if (ci.val[2] == 203 || (ci.val[2] == -30120 && x == 4 && y == 19)) {
                                cell.summoningCircle = SummoningCircle.CIRCLE4;
                            }
                            if (ci.val[2] == 204) {
                                cell.summoningCircle = SummoningCircle.CIRCLE5;
                            }
                            if (ci.val[2] == -30480 && x == 5 && y == 5) {
                                cell.summoningCircle = SummoningCircle.CIRCLE6;
                            }
                            if (ci.val[2] == 206) {
                                cell.summoningCircle = SummoningCircle.CIRCLE7;
                            }
                            if (ci.val[2] == 207) {
                                cell.summoningCircle = SummoningCircle.CIRCLE8;
                            }
                            if (ci.val[2] == -30220 && ((x == 0 && y == 2) || (x == 13 && y == 6) || (x == 9 && y == 8) || (x == 4 && y == 16))) {
                                cell.summoningCircle = SummoningCircle.CIRCLE9;
                            }
                            if (ci.val[2] == -30120 && ((x == 9 && y == 8) || (x == 3 && y == 16) || (x == 14 && y == 16))) {
                                cell.summoningCircle = SummoningCircle.CIRCLE10;
                            }

                            if (ci.val[1] >= 0 && ci.val[2] >= 0 && ci.val[2] <= 231 && cell.summoningCircle == null) {
                                cell.message = getMessage(messages, ci.val[1]);
                                if (cell.message == null && cell.summoningCircle == null && cell.encounterID == -1) {
                                    cell.tbd = true;
                                }
                            }

                            if (ci.val[0] == 0 && ci.val[1] == 0 && ci.val[2] < 0 && cell.summoningCircle == null) {
                                cell.tbd = true;
                            }

                            mazeOfWanderingHelper(x, y, cell, ci, messages);

                            break;
                    }
                }
            }
        }

        private MazeCell walls(int row, int column) {
            MazeAddress address = new MazeAddress(level, row, column);
            MazeCell cell = new MazeCell(address);

            // doors and walls
            int offset = column * 6 + row / 4; // 6 bytes/column

            int value = intValue(buffer[offset]);
            value >>>= (row % 4) * 2;
            cell.westWall = ((value & 1) == 1);
            value >>>= 1;
            cell.westDoor = ((value & 1) == 1);

            value = intValue(buffer[offset + 120]);
            value >>>= (row % 4) * 2;
            cell.southWall = ((value & 1) == 1);
            value >>>= 1;
            cell.southDoor = ((value & 1) == 1);

            value = intValue(buffer[offset + 240]);
            value >>>= (row % 4) * 2;
            cell.eastWall = ((value & 1) == 1);
            value >>>= 1;
            cell.eastDoor = ((value & 1) == 1);

            value = intValue(buffer[offset + 360]);
            value >>>= (row % 4) * 2;
            cell.northWall = ((value & 1) == 1);
            value >>>= 1;
            cell.northDoor = ((value & 1) == 1);

            if (cell.eastWall && cell.eastDoor) {
                cell.hiddenEastDoor = true;
            }
            if (cell.westWall && cell.westDoor) {
                cell.hiddenWestDoor = true;
            }
            if (cell.northWall && cell.northDoor) {
                cell.hiddenNorthDoor = true;
            }
            if (cell.southWall && cell.southDoor) {
                cell.hiddenSouthDoor = true;
            }

            return cell;
        }

        private byte[][] getCellInfoLocations(byte[] buffer, int offset) {
            byte[][] sqrextra = new byte[20][20];
            for (int col = 0; col < 20; col++) {
                for (int row = 0; row < 20; row += 2) {
                    sqrextra[col][row] = (byte) (buffer[offset] & 0x0F);
                    sqrextra[col][row + 1] = (byte) ((buffer[offset] & 0xF0) >>> 4);
                    offset++;
                }
            }
            return sqrextra;
        }

        private CellInfo[] getCellInfo(byte[] buffer, int offset) {
            CellInfo[] info = new CellInfo[16];

            int pos = 0;
            for (int i = 0; i < 8; i++) {
                info[pos] = new CellInfo(pos++, buffer, offset);
                info[pos] = new CellInfo(pos++, buffer, offset);
            }

            return info;
        }

        private EncounterOdds[] getMonsterOdds(byte[] buffer, int offset) {
            EncounterOdds[] enemyCalc = new EncounterOdds[3];

            for (int i = 0; i < 3; i++) {
                enemyCalc[i] = new EncounterOdds(buffer, offset);
                offset += 10;
            }

            return enemyCalc;
        }

        @Override
        public int getRandomMonster() {
            int encounterType = 0;
            while (RANDOM.nextInt(4) == 2 && encounterType < 2) {
                ++encounterType;
            }

            return monsterOdds[encounterType].getRandomMonster();
        }

    }

    public static class MazeAddress {

        public final int level;
        public final int row;
        public final int column;

        public MazeAddress(int level, int row, int column) {
            this.level = level;
            this.row = row;
            this.column = column;
        }

        @Override
        public int hashCode() {
            int hash = 7;
            hash = 23 * hash + this.level;
            hash = 23 * hash + this.row;
            hash = 23 * hash + this.column;
            return hash;
        }

        @Override
        public boolean equals(Object obj) {
            if (this == obj) {
                return true;
            }
            if (obj == null) {
                return false;
            }
            if (getClass() != obj.getClass()) {
                return false;
            }
            final MazeAddress other = (MazeAddress) obj;
            if (this.level != other.level) {
                return false;
            }
            if (this.row != other.row) {
                return false;
            }
            return this.column == other.column;
        }

        @Override
        public String toString() {
            return level + "\t" + row + "\t" + column;
        }
    }

    public static class MazeCell {

        boolean northWall;
        boolean southWall;
        boolean eastWall;
        boolean westWall;

        boolean northDoor;
        boolean southDoor;
        boolean eastDoor;
        boolean westDoor;

        boolean hiddenNorthDoor;
        boolean hiddenSouthDoor;
        boolean hiddenEastDoor;
        boolean hiddenWestDoor;

        public boolean darkness;
        public boolean stairs;
        public boolean pit;
        public boolean cage;
        public boolean spinner;
        public int rotateDirection = -1;
        public boolean chute;
        public boolean elevator;
        public boolean rock;
        public boolean teleport;
        public boolean spellsBlocked;
        public boolean tbd;

        public int feeAmount;
        public int tradeItem1;
        public int tradeItem2;
        public List<String> riddleAnswers;
        public int itemObtainedFromRiddle;
        public Dice damage;
        public Message message;
        public int itemRequired;
        public int itemObtained;
        public Function function;

        public boolean lair;
        private boolean tempLair;

        public int encounterID = -1;
        public int encounterTakeItem = -1;
        public int encounterGiveItem = -1;
        public Message encounterTradeSuccessMessage;
        public List<Integer> fightIfDoNotOwnAnyOfItems = new ArrayList<>();
        public boolean hasTreasureChest;
        public int wanderingEncounterID = -1;

        public SummoningCircle summoningCircle;

        public MazeAddress address;
        public MazeAddress addressTo;
        public int elevatorFrom;
        public int elevatorTo;

        public MazeCell(MazeAddress address) {
            this.address = address;
        }

        @Override
        public int hashCode() {
            int hash = 7;
            hash = 83 * hash + Objects.hashCode(this.address);
            return hash;
        }

        @Override
        public boolean equals(Object obj) {
            if (this == obj) {
                return true;
            }
            if (obj == null) {
                return false;
            }
            if (getClass() != obj.getClass()) {
                return false;
            }
            final MazeCell other = (MazeCell) obj;
            return Objects.equals(this.address, other.address);
        }

    }

    public static Message getMessage(List<Message> messages, int id) {
        for (Message m : messages) {
            if (m.match(id)) {
                return m;
            }
        }
        return null;
    }

    public static class Message {

        private int id;
        private final List<String> text = new ArrayList<>();

        public Message() {

        }

        public Message(String text) {
            this.text.add(text);
        }

        public Message(Message... messages) {
            for (Message m : messages) {
                for (String s : m.text) {
                    this.text.add(s);
                }
                this.text.add(" ");
            }
        }

        public boolean match(int messageNum) {
            if (id == messageNum) {
                return true;
            }
            return false;
        }

        public String getText() {
            StringBuilder t = new StringBuilder();
            for (String line : text) {
                if (line.equals(" ")) {
                    t.append("\n\n");
                } else {
                    t.append(line.replace("^", ""));
                    t.append(" ");
                }
            }
            t.deleteCharAt(t.length() - 1);
            return t.toString();
        }

        public List<String> text() {
            return this.text;
        }

    }

    private static class EncounterOdds {

        private final int minEnemy;
        private final int rangeSize;
        private final int extraRangeOdds;
        private final int totExtraRanges;
        private final int extraRangeOffset;

        public EncounterOdds(byte[] buffer, int offset) {
            minEnemy = EndianUtils.readSwappedShort(buffer, offset);
            extraRangeOffset = EndianUtils.readSwappedShort(buffer, offset + 2);
            totExtraRanges = EndianUtils.readSwappedShort(buffer, offset + 4);
            rangeSize = EndianUtils.readSwappedShort(buffer, offset + 6);
            extraRangeOdds = EndianUtils.readSwappedShort(buffer, offset + 8);
        }

        public int getRandomMonster() {
            int rangeNo = 0;
            while (RANDOM.nextInt(100) < extraRangeOdds && rangeNo < totExtraRanges) {
                ++rangeNo;
            }
            return minEnemy + RANDOM.nextInt(rangeSize) + extraRangeOffset * rangeNo;
        }

        @Override
        public String toString() {
            return "EncounterOdds{" + "minEnemy=" + minEnemy + ", rangeSize=" + rangeSize + ", extraRangeOdds=" + extraRangeOdds + ", totExtraRanges=" + totExtraRanges + ", extraRangeOffset=" + extraRangeOffset + '}';
        }

    }

    private static class CellInfo {

        private final CellType type;
        private final short[] val = new short[3];
        private final byte[][] data = new byte[3][2];

        public CellInfo(int index, byte[] buffer, int offset) {
            byte b = buffer[offset + (index) / 2];
            int idx = index % 2 == 0 ? b & 0x0F : (b & 0xF0) >>> 4;
            this.type = CellType.values()[idx];

            this.data[0][0] = buffer[offset + 8 + index * 2];
            this.data[0][1] = buffer[offset + 8 + index * 2 + 1];
            this.data[1][0] = buffer[offset + 40 + index * 2];
            this.data[1][1] = buffer[offset + 40 + index * 2 + 1];
            this.data[2][0] = buffer[offset + 72 + index * 2];
            this.data[2][1] = buffer[offset + 72 + index * 2 + 1];

            this.val[0] = EndianUtils.readSwappedShort(buffer, offset + 8 + index * 2);
            this.val[1] = EndianUtils.readSwappedShort(buffer, offset + 40 + index * 2);
            this.val[2] = EndianUtils.readSwappedShort(buffer, offset + 72 + index * 2);
        }

        public boolean isMessage() {
            return type == CellType.MESSAGE && val[2] >= 0 && val[2] <= 13;
        }

        @Override
        public String toString() {
            short cb1 = EndianUtils.readSwappedShort(this.data[0], 0);
            String hx1 = String.format("%04x", cb1);
            short cb2 = EndianUtils.readSwappedShort(this.data[1], 0);
            String hx2 = String.format("%04x", cb2);
            short cb3 = EndianUtils.readSwappedShort(this.data[2], 0);
            String hx3 = String.format("%04x", cb3);
            return String.format("%-8s  [%5d  %4d  %4d] [%s %s %s]", type, val[0], val[1], val[2], hx1, hx2, hx3);
        }
    }

    private static void mazeOfWanderingHelper(int x, int y, MazeCell cell, CellInfo ci, List<Message> messages) {
        if (ci.type == CellType.MESSAGE) {

            if (x == 14 && y == 5 && ci.val[1] == 191) {
                cell.function = (Context ctx, BaseScreen screen) -> new WitchInMazeDialog(ctx, screen);
            }

            if (ci.val[2] == -30450) {
                if (x == 2 && y == 1) {
                    cell.message = getMessage(messages, 93);
                }
                if ((x == 3 && y == 3) || (x == 15 && y == 3) || (x == 14 && y == 8) || (x == 2 && y == 14) || (x == 13 && y == 18) || (x == 11 && y == 6)) {
                    cell.message = getMessage(messages, 92);
                    cell.cage = true;
                }
                if (x == 15 && y == 18) {
                    cell.message = getMessage(messages, 94);
                }
                cell.tbd = false;
            }

            if (ci.val[0] == 13 && ci.val[1] == 210) {
                cell.itemObtained = 13;//aromatic ball white sphere
                cell.message = getMessage(messages, 210);
            }
        }
    }

    private static final int[][] wiz4Addrs = new int[][]{
        {3, 17, 18, 1, 19, 19},
        {1, 17, 15, 2, 12, 19},
        {2, 15, 11, 1, 17, 2},
        {2, 10, 18, 3, 14, 19},
        {3, 16, 19, 1, 19, 6},
        {3, 17, 19, 1, 3, 16},
        {3, 18, 19, 1, 13, 14},
        {3, 19, 19, 2, 14, 1},
        {3, 16, 17, 2, 7, 5},
        {1, 16, 16, 3, 8, 14},
        {1, 12, 3, 3, 8, 14},
        {1, 14, 6, 2, 12, 19},
        {1, 12, 6, 2, 12, 19},
        {1, 18, 7, 3, 8, 14},
        {1, 15, 19, 1, 11, 15},
        {1, 11, 13, 3, 8, 14},
        {1, 7, 12, 3, 10, 16},
        {1, 8, 5, 2, 12, 19},
        {1, 12, 0, 3, 11, 13},
        {1, 5, 8, 3, 8, 3},
        {1, 9, 3, 2, 4, 1},
        {1, 2, 8, 2, 16, 19},
        {1, 9, 9, 3, 5, 11},
        {1, 13, 16, 2, 14, 1},
        {1, 13, 14, 1, 19, 19},
        {1, 15, 11, 3, 11, 13},
        {1, 1, 3, 3, 11, 13},
        {1, 2, 1, 3, 10, 16},
        {1, 9, 7, 3, 11, 13},
        {1, 16, 15, 0, 0, 1},
        {3, 13, 14, 2, 9, 0},
        {3, 19, 14, 1, 19, 6},
        {2, 2, 18, 1, 7, 0},
        {2, 8, 10, 3, 9, 10},
        {2, 8, 14, 1, 9, 13},
        {2, 9, 10, 2, 19, 5},
        {2, 11, 8, 1, 7, 0},
        {2, 16, 6, 1, 19, 9},
        {3, 0, 18, 2, 14, 1},
        {3, 1, 15, 2, 9, 0},
        {3, 1, 16, 2, 7, 3},
        {3, 2, 1, 2, 7, 12},
        {3, 2, 10, 1, 0, 3},
        {3, 2, 15, 3, 8, 12},
        {3, 2, 16, 1, 19, 19},
        {3, 2, 18, 1, 19, 19},
        {3, 8, 19, 3, 8, 12},
        {3, 10, 18, 1, 19, 6},
        {3, 11, 12, 2, 9, 14},
        {3, 12, 9, 3, 16, 12},
        {3, 13, 18, 2, 14, 1},
        {3, 16, 1, 3, 11, 8},
        {3, 18, 1, 2, 9, 0},
        {3, 5, 1, 1, 19, 19},
        {3, 16, 14, 1, 19, 19},
        {0, 0, 1, 1, 16, 15},
        {0, 11, 14, 12, 12, 14},
        {0, 15, 2, 12, 15, 3},
        {0, 15, 9, 12, 15, 8},
        {5, 3, 18, 5, 2, 11},
        {5, 8, 13, 5, 0, 16},
        {12, 3, 3, 13, 2, 2},
        {12, 3, 16, 13, 2, 17},
        {12, 12, 14, 0, 11, 14},
        {12, 15, 3, 0, 15, 2},
        {12, 15, 8, 0, 15, 9},
        {12, 15, 9, 13, 15, 8},
        {12, 16, 3, 13, 16, 2},
        {12, 16, 16, 13, 16, 17},
        {13, 3, 2, 12, 3, 3},
        {13, 3, 17, 12, 3, 16},
        {13, 15, 8, 12, 15, 9},
        {13, 16, 2, 12, 16, 3},
        {13, 16, 17, 12, 16, 16},};

    static {
        wiz4Customization(WER_LEVELS);
    }

    public static String[] HAWKWIND_REPLIES = new String[]{
        "Laughs",
        "Chuckles",
        "Snickers",
        "Reads \"Pikestaff\"",
        "Answers His Mail",
        "Files His Nails",
        "Sends Out For Sushi",
        "Ignores You",
        "Pets His Dragons",
        "Pays For The Sushi",
        "Feeds Sushi To His Dragons",
        "Pretends To Take A Nap",
        "Really Falls Asleep (From Boredom)",
        "Wakes Up",
        "Brushes His Teeth",
        "Brews Tea",
        "Oils His Blade",
        "Says His Morning Prayers",
        "Petitions To Offer You Up As A Sacrifice",
        "Fills Out Sacrificial Order Form In Triplicate",
        "Gets Approval For Your Sacrifice",
        "Binds And Gags You",
        "Puts You On The Sacrificial Altar",
        "Anoints You With Sacrificial Oils",
        "Sacrifices You To Kadorto"
    };

    private static void wiz4Customization(MazeLevel[] levels) {
        for (int i = 0; i < wiz4Addrs.length; i++) {
            MazeLevel fromLevel = levels[wiz4Addrs[i][0]];
            MazeLevel toLevel = levels[wiz4Addrs[i][3]];
            MazeCell cell = fromLevel.cells[wiz4Addrs[i][1]][wiz4Addrs[i][2]];
            if (cell.addressTo != null) {
                cell.addressTo = new MazeAddress(wiz4Addrs[i][3] + 1, wiz4Addrs[i][4], wiz4Addrs[i][5]);
            } else {
                System.out.printf("unexpected null cell addressTo on %d,%d,%d\n", wiz4Addrs[i][0], wiz4Addrs[i][1], wiz4Addrs[i][2]);
            }
        }

        for (MazeLevel l : levels) {
            //System.out.println(WER_LEVEL_DESC[l.level - 1]);
            for (int x = 0; x < DUNGEON_DIM; x++) {
                for (int y = 0; y < DUNGEON_DIM; y++) {
                    WizardryData.MazeCell c = l.cells[x][y];
                    if (c.addressTo != null) {
                        //System.out.printf("%d,%d,%d %s\n", l.level, x, y, c.addressTo);
                    }
                    if (x == 1 && y == 2 && l.level == 10) {
                        c.message = getMessage(WER_MESSAGES, 28);
                        c.tbd = false;
                    }
                    if (x == 14 && y == 13 && l.level == 10) {
                        c.message = getMessage(WER_MESSAGES, 31);
                        c.tbd = false;
                    }
                    if (x == 6 && y == 11 && l.level == 10) {
                        c.message = getMessage(WER_MESSAGES, 36);
                        c.tbd = false;
                    }
                    if (x == 6 && y == 10 && l.level == 10) {
                        c.message = getMessage(WER_MESSAGES, 37);
                        c.tbd = false;
                    }
                    if (x == 7 && y == 10 && l.level == 10) {
                        c.message = getMessage(WER_MESSAGES, 38);
                        c.tbd = false;
                    }
                    if (x == 10 && y == 10 && l.level == 10) {
                        c.message = getMessage(WER_MESSAGES, 44);
                        c.tbd = false;
                    }
                    if (x == 10 && y == 9 && l.level == 10) {
                        c.function = (Context ctx, BaseScreen screen) -> new GatesOfHellDialog(ctx, screen);
                        c.tbd = false;
                    }
                    if (x == 19 && y == 8 && l.level == 9) {
                        c.message = getMessage(WER_MESSAGES, 56);
                        c.tbd = false;
                    }
                    if (x == 19 && y == 10 && l.level == 9) {
                        c.message = getMessage(WER_MESSAGES, 54);
                        c.tbd = false;
                    }
                    if (x == 0 && y == 1 && l.level == 9) {
                        c.message = getMessage(WER_MESSAGES, 57);
                        c.tbd = false;
                    }
                    if (x == 9 && y == 0 && l.level == 9) {
                        c.itemObtained = 88;//golden pyrite
                    }
                    if (x == 1 && y == 14 && l.level == 9) {
                        c.message = new Message(getMessage(WER_MESSAGES, 149), getMessage(WER_MESSAGES, 154), getMessage(WER_MESSAGES, 148));
                        c.itemObtained = 12;
                        c.tbd = false;
                    }
                    if (x == 0 && y == 1 && l.level == 8) {
                        c.message = getMessage(WER_MESSAGES, 71);
                        c.tbd = false;
                    }
                    if (((x == 2 && (y == 0 || y == 19)) || (x == 4 && (y == 1 || y == 18))) && l.level == 8) {
                        c.message = getMessage(WER_MESSAGES, 70);
                        c.tbd = false;
                    }
                    if (x == 8 && y == 6 && l.level == 8) {
                        c.itemRequired = 5;//winged boots
                        c.tbd = false;
                    }
                    if (x == 8 && y == 5 && l.level == 8) {
                        c.hiddenEastDoor = true;//dreampainter room
                    }
                    if (x == 14 && y == 8 && l.level == 8) {
                        c.itemRequired = 103;//black candle
                        c.tbd = false;
                    }
                    if (x == 18 && y == 9 && l.level == 8) {
                        c.message = getMessage(WER_MESSAGES, 72);
                        c.tbd = false;
                        c.lair = false;
                    }
                    if (x == 18 && y == 10 && l.level == 8) {
                        c.message = getMessage(WER_MESSAGES, 73);
                        c.tbd = false;
                        c.lair = false;
                    }
                    if (x == 19 && y == 9 && l.level == 8) {
                        c.function = (Context ctx, BaseScreen screen) -> new ZigguratAltarDialog(ctx, screen);
                        c.tbd = false;
                        c.lair = false;
                    }
                    if (x == 19 && y == 10 && l.level == 8) {
                        c.lair = false;
                    }
                    if (x == 18 && y == 8 && l.level == 8) {
                        c.message = getMessage(WER_MESSAGES, 74);
                        c.tbd = false;
                    }
                    if (x == 18 && y == 11 && l.level == 8) {
                        c.message = getMessage(WER_MESSAGES, 75);
                        c.tbd = false;
                    }
                    if (x == 1 && y == 0 && l.level == 6) {
                        c.message = getMessage(WER_MESSAGES, 102);
                        c.tbd = false;
                    }
                    if (x == 0 && y == 1 && l.level == 6) {
                        c.message = getMessage(WER_MESSAGES, 102);
                        c.tbd = false;
                    }
                    if (x == 18 && y == 9 && l.level == 6) {
                        c.itemObtained = 89;//oxygen mask
                        c.message = getMessage(WER_MESSAGES, 100);
                        c.tbd = false;
                    }
                    if (x == 12 && y == 15 && l.level == 2) {
                        c.message = getMessage(WER_MESSAGES, 97);
                    }
                    if (x == 14 && y == 3 && l.level == 3) {
                        c.function = (Context ctx, BaseScreen screen) -> new VanishingCreamDialog(ctx, screen);
                        c.tbd = false;
                        c.lair = false;
                        c.encounterID = -1;
                        c.message = null;
                    }
                    if (x == 2 && y == 13 && l.level == 2) {
                        c.function = (Context ctx, BaseScreen screen) -> new BuyStTreborsRumpDialog(ctx, screen);
                        c.tbd = false;
                        c.lair = false;
                        c.encounterID = -1;
                        c.message = null;
                    }
                    if (x == 15 && y == 18 && l.level == 2) {
                        c.message = new Message("<- <- <- This way to the Egress");
                    }
                    if (x == 15 && y == 15 && l.level == 2) {
                        c.message = new Message("Egress  -> -> ->");
                    }
                    if (x == 0 && y == 0 && l.level == 1) {
                        c.message = getMessage(WER_MESSAGES, 120);
                        c.tbd = false;
                    }
                    if (x == 1 && y == 9 && l.level == 1) {
                        c.encounterID = -1;
                    }
                    if (x == 3 && y == 6 && l.level == 1) {
                        c.message = getMessage(WER_MESSAGES, 121);
                        c.tradeItem1 = 5;
                        c.tradeItem2 = 0;//lose the winged boots for traversing the castle so pits are not voided
                        c.tbd = false;
                    }
                    if (x == 3 && y == 9 && l.level == 1) {
                        c.message = getMessage(WER_MESSAGES, 122);
                        c.encounterID = 402;//training squad 3
                        c.tbd = false;
                    }
                    if (x == 3 && y == 12 && l.level == 1) {
                        c.message = getMessage(WER_MESSAGES, 129);
                        c.tbd = false;//boltacs
                    }
                    if (x == 4 && y == 12 && l.level == 1) {
                        c.encounterID = 408;//anti shoplifting unit
                        c.tbd = false;
                    }
                    if (x == 10 && y == 16 && l.level == 1) {
                        c.message = getMessage(WER_MESSAGES, 124);
                        c.tbd = false;//adv inn
                    }
                    if (x == 9 && y == 16 && l.level == 1) {
                        c.encounterID = -1;
                        c.lair = false;
                    }
                    if (x == 16 && y == 9 && l.level == 1) {//captains council
                        c.message = getMessage(WER_MESSAGES, 111);
                        c.fightIfDoNotOwnAnyOfItems.add(17);//crystal rose
                        c.encounterGiveItem = 110;//rallying horn
                        c.encounterTradeSuccessMessage = new Message("");
                        c.encounterID = 454;
                        c.tbd = false;
                    }
                    if (x == 16 && y == 9 && l.level == 13) {//council of barons
                        c.message = new Message(getMessage(WER_MESSAGES, 143), getMessage(WER_MESSAGES, 144));
                        c.fightIfDoNotOwnAnyOfItems.add(17);//crystal rose
                        c.encounterGiveItem = 111;//signet ring
                        c.encounterTradeSuccessMessage = new Message("");
                        c.encounterID = 460;
                        c.tbd = false;
                    }
                    if (x == 9 && y == 13 && l.level == 1) {//von halstern chivalry
                        c.message = new Message(getMessage(WER_MESSAGES, 110));
                        c.fightIfDoNotOwnAnyOfItems.add(17);//crystal rose
                        c.encounterID = 442;
                        c.tbd = false;
                    }
                    if (x == 9 && y == 12 && l.level == 1) {
                        c.elevator = false;
                        c.stairs = true;
                        c.addressTo = new MazeAddress(13, 9, 12);
                    }
                    if (x == 9 && y == 12 && l.level == 13) {
                        c.elevator = false;
                        c.stairs = true;
                        c.addressTo = new MazeAddress(1, 9, 12);
                    }
                    if (x == 9 && y == 7 && l.level == 13) {
                        c.elevator = false;
                        c.stairs = true;
                        c.addressTo = new MazeAddress(14, 9, 7);
                    }
                    if (x == 9 && y == 7 && l.level == 14) {
                        c.elevator = false;
                        c.stairs = true;
                        c.addressTo = new MazeAddress(13, 9, 7);
                    }
                    if (x == 16 && y == 13 && l.level == 1) {
                        c.message = new Message(getMessage(WER_MESSAGES, 152), getMessage(WER_MESSAGES, 155));
                        c.itemObtained = -1;
                        c.tbd = false;
                        c.encounterID = -1;
                        c.lair = false;
                    }
                    if (x == 16 && y == 5 && l.level == 1) {
                        c.function = (Context ctx, BaseScreen screen) -> new BathInPoolDialog(ctx, screen);
                        c.tbd = false;
                        c.lair = false;
                        c.encounterID = -1;
                        c.message = null;
                    }
                    if (x == 13 && y == 14 && l.level == 13) {//tiger cubs
                        c.message = new Message(getMessage(WER_MESSAGES, 107), getMessage(WER_MESSAGES, 108));
                        c.encounterTradeSuccessMessage = getMessage(WER_MESSAGES, 109);
                        c.encounterTakeItem = 19;//pennencaux
                        c.encounterGiveItem = 109;//gold orb
                        c.encounterID = 436;
                        c.tbd = false;
                    }
                    if (x == 11 && y == 14 && l.level == 13) {//order of laurel
                        c.message = new Message(getMessage(WER_MESSAGES, 104), getMessage(WER_MESSAGES, 105));
                        c.encounterTradeSuccessMessage = getMessage(WER_MESSAGES, 106);
                        c.encounterTakeItem = 18;//dabpuce
                        c.encounterGiveItem = 108;//arrow truth
                        c.encounterID = 430;
                        c.tbd = false;
                    }
                    if (x == 13 && y == 15 && l.level == 13) {//order of pelicans
                        c.message = new Message(getMessage(WER_MESSAGES, 136));
                        c.encounterTradeSuccessMessage = getMessage(WER_MESSAGES, 138);
                        c.fightIfDoNotOwnAnyOfItems.add(7);
                        c.fightIfDoNotOwnAnyOfItems.add(8);
                        c.fightIfDoNotOwnAnyOfItems.add(9);//east wind sword, west wind sword dragons claw
                        c.encounterGiveItem = 20;//maint cap
                        c.encounterID = 424;
                        c.tbd = false;
                    }
                    if (x == 11 && y == 15 && l.level == 13) {//ladies of the rose
                        c.message = new Message(getMessage(WER_MESSAGES, 131), getMessage(WER_MESSAGES, 134));
                        c.encounterTradeSuccessMessage = getMessage(WER_MESSAGES, 135);
                        c.encounterTakeItem = 120;//bar of soap
                        c.encounterGiveItem = 17;//crystal rose
                        c.encounterID = 418;
                        c.tbd = false;
                    }
                    if (x == 15 && y == 9 && l.level == 14) {//Great Dukes of the Realm
                        c.function = (Context ctx, BaseScreen screen) -> new DukesDialog(ctx, screen);
                        c.tbd = false;
                        c.lair = false;
                        c.encounterID = -1;
                        c.message = null;
                    }
                    if (x == 17 && y == 9 && l.level == 14) {
                        c.itemObtainedFromRiddle = 112;//mythril gloves
                        c.encounterID = -1;
                        c.tbd = false;
                        c.northWall = false;
                        c.eastWall = false;
                        c.westWall = false;
                    }
                    if (x == 9 && y == 11 && l.level == 14) {
                        c.message = new Message(getMessage(WER_MESSAGES, 204), getMessage(WER_MESSAGES, 205));
                        c.itemObtained = 14;//void transducer
                        c.tbd = false;
                    }
                    if (x == 9 && y == 11 && l.level == 13) {
                        c.encounterID = -1;
                    }
                    if (x == 9 && y == 8 && l.level == 13) {
                        c.encounterID = 448;//all stars
                    }
                    if (x == 9 && y == 6 && l.level == 14) {
                        c.encounterID = -1;
                    }
                    if (x == 11 && y == 5 && l.level == 14) {
                        c.encounterID = 487;//temple priests
                    }
                    if (x == 12 && y == 4 && l.level == 14) {
                        c.message = new Message(getMessage(WER_MESSAGES, 200));
                        c.encounterID = 499;//hawkwind
                    }
                }
            }
        }

    }

}
